<HTML>
<HEAD>
<TITLE>Spreadsheet::WriteExcel - Write to a cross-platform Excel binary file.</TITLE>
<LINK REV="made" HREF="mailto:">
</HEAD>

<style type="text/css">   



   <!--
   
   pre  {
        font-family : courier new, sans-serif;
        font-size : 10pt;
        color : #0066cc;
   }

   CODE  {
        font-family : courier new, sans-serif;
        font-size : 10pt;
        color : #0066cc;
   }
   
         
   -->
</style>


<BODY>

<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#NAME">NAME</A></LI>
	<LI><A HREF="#VERSION">VERSION</A></LI>
	<LI><A HREF="#SYNOPSIS">SYNOPSIS</A></LI>
	<LI><A HREF="#DESCRIPTION">DESCRIPTION</A></LI>
	<LI><A HREF="#WORKBOOK_METHODS">WORKBOOK METHODS</A></LI>
	<UL>

        <code><LI><A HREF="#new_">new()</A></LI>
        <LI><A HREF="#close_">close()</A></LI>
        <LI><A HREF="#addworksheet_sheetname_">addworksheet($sheetname)</A></LI>
        <LI><A HREF="#addformat_">addformat()</A></LI>
        <LI><A HREF="#worksheets_">worksheets()</A></LI>
        <LI><A HREF="#set_1904_">set_1904()</A></LI></code>
	</UL>

	<LI><A HREF="#WORKSHEET_METHODS">WORKSHEET METHODS</A></LI>
	<UL>

        <code><LI><A HREF="#Cell_notation">Cell notation</A></LI>
        <LI><A HREF="#write_row_column_token_fo">write($row, $column, $token, $format)</A></LI>
        <LI><A HREF="#write_number_row_column_num">write_number($row, $column, $number, $format)</A></LI>
        <LI><A HREF="#write_string_row_column_str">write_string($row, $column, $string, $format)</A></LI>
        <LI><A HREF="#write_formula_row_column_fo">write_formula($row, $column, $formula, $format)</A></LI>
        <LI><A HREF="#write_blank_row_column_form">write_blank($row, $column, $format)</A></LI>
        <LI><A HREF="#write_url_row_col_url_str">write_url($row, $col, $url, $string, $format)</A></LI>
        <LI><A HREF="#activate_">activate()</A></LI>
        <LI><A HREF="#select_">select()</A></LI>
        <LI><A HREF="#set_first_sheet_">set_first_sheet()</A></LI>
        <LI><A HREF="#set_selection_first_row_first">set_selection($first_row, $first_col, $last_row, $last_col);</A></LI>
        <LI><A HREF="#set_row_row_height_format_">set_row($row, $height, $format);</A></LI>
        <LI><A HREF="#set_column_first_col_last_col">set_column($first_col, $last_col, $width, $format);</A></LI>
        <LI><A HREF="#freeze_panes_row_col_top_ro">freeze_panes($row, $col, $top_row, $left_col);</A></LI>
        <LI><A HREF="#thaw_panes_y_x_top_row_le">thaw_panes($y, $x, $top_row, $left_col);</A></LI></code>
	</UL>

	<LI><A HREF="#PAGE_SETUP_METHODS">PAGE SETUP METHODS</A></LI>
	<UL>

        <code><LI><A HREF="#set_landscape_">set_landscape()</A></LI>
        <LI><A HREF="#set_portrait_">set_portrait()</A></LI>
        <LI><A HREF="#set_paper_index_">set_paper($index)</A></LI>
        <LI><A HREF="#center_horizontally_">center_horizontally()</A></LI>
        <LI><A HREF="#center_vertically_">center_vertically()</A></LI>
        <LI><A HREF="#set_margins_inches_">set_margins($inches)</A></LI>
        <LI><A HREF="#set_header_string_margin_">set_header($string, $margin)</A></LI>
        <LI><A HREF="#set_footer_">set_footer()</A></LI></code>
	</UL>

	<LI><A HREF="#FORMAT_METHODS">FORMAT METHODS</A></LI>
	<UL>

        <<code>LI><A HREF="#copy_format_">copy($format)</A></LI>
        <LI><A HREF="#set_font_fontname_">set_font($fontname)</A></LI>
        <LI><A HREF="#set_size_">set_size()</A></LI>
        <LI><A HREF="#set_color_">set_color()</A></LI>
        <LI><A HREF="#set_bold_">set_bold()</A></LI>
        <LI><A HREF="#set_italic_">set_italic()</A></LI>
        <LI><A HREF="#set_underline_">set_underline()</A></LI>
        <LI><A HREF="#set_strikeout_">set_strikeout()</A></LI>
        <LI><A HREF="#set_script_">set_script()</A></LI>
        <LI><A HREF="#set_outline_">set_outline()</A></LI>
        <LI><A HREF="#set_shadow_">set_shadow()</A></LI>
        <LI><A HREF="#set_num_format_">set_num_format()</A></LI>
        <LI><A HREF="#set_align_">set_align()</A></LI>
        <LI><A HREF="#set_merge_">set_merge()</A></LI>
        <LI><A HREF="#set_text_wrap_">set_text_wrap()</A></LI>
        <LI><A HREF="#set_rotation_">set_rotation()</A></LI>
        <LI><A HREF="#set_text_justlast_">set_text_justlast()</A></LI>
        <LI><A HREF="#set_pattern_">set_pattern()</A></LI>
        <LI><A HREF="#set_fg_color_">set_fg_color()</A></LI>
        <LI><A HREF="#set_border_">set_border()</A></LI>
        <LI><A HREF="#set_border_color_">set_border_color()</A></LI></code>
	</UL>

	<LI><A HREF="#FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL</A></LI>
	<LI><A HREF="#EXAMPLES">EXAMPLES</A></LI>
	<UL>

        <code><LI><A HREF="#Example_1">Example 1</A></LI>
        <LI><A HREF="#Example_2">Example 2</A></LI>
        <LI><A HREF="#Example_3">Example 3</A></LI>
        <LI><A HREF="#Example_4">Example 4</A></LI>
        <LI><A HREF="#Example_5">Example 5</A></LI></code>
	</UL>

	<LI><A HREF="#LIMITATIONS">LIMITATIONS</A></LI>
	<LI><A HREF="#REQUIREMENTS">REQUIREMENTS</A></LI>
	<LI><A HREF="#PORTABILITY">PORTABILITY</A></LI>
	<LI><A HREF="#DIAGNOSTICS">DIAGNOSTICS</A></LI>
	<LI><A HREF="#THE_EXCEL_BINARY_FORMAT">THE EXCEL BINARY FORMAT</A></LI>
	<LI><A HREF="#WRITING_EXCEL_FILES">WRITING EXCEL FILES</A></LI>
	<LI><A HREF="#READING_EXCEL_FILES">READING EXCEL FILES</A></LI>
	<LI><A HREF="#BUGS">BUGS</A></LI>
	<LI><A HREF="#TO_DO">TO DO</A></LI>
	<LI><A HREF="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</A></LI>
	<LI><A HREF="#AUTHOR">AUTHOR</A></LI>
	<LI><A HREF="#COPYRIGHT">COPYRIGHT</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="NAME">NAME</A></H1>
<P>
Spreadsheet::WriteExcel - Write to a cross-platform Excel binary file.

</P>
<P>
<HR>
<H1><A NAME="VERSION">VERSION</A></H1>
<P>
This document refers to version 0.32 of Spreadsheet::WriteExcel, released
May 17, 2001.

</P>
<P>
<HR>
<H1><A NAME="SYNOPSIS">SYNOPSIS</A></H1>
<P>
To write a string, a formatted string, a number and a formula to the first
worksheet in an Excel workbook called perl.xls:

</P>
<P>
<PRE>
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    # Create a new Excel workbook
    my $workbook = Spreadsheet::WriteExcel-&gt;new(&quot;perl.xls&quot;);
</PRE>
</P>
<P>
<PRE>
    # Add a worksheet
    $worksheet = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<PRE>
    #  Add and define a format
    $format = $workbook-&gt;addformat(); # Add a format
    $format-&gt;set_bold();
    $format-&gt;set_color('red');
    $format-&gt;set_align('center');
</PRE>
</P>
<P>
<PRE>
    # Write a formatted and unformatted string, row and column notation.
    $col = $row = 0;
    $worksheet-&gt;write($row, $col, &quot;Hi Excel!&quot;, $format);
    $worksheet-&gt;write(1,    $col, &quot;Hi Excel!&quot;);
</PRE>
</P>
<P>
<PRE>
    # Write a number and a formula using A1 notation
    $worksheet-&gt;write('A3', 1.2345);
    $worksheet-&gt;write('A4', '=SIN(PI()/4)');
</PRE>
</P>
<P>
<HR>
<H1><A NAME="DESCRIPTION">DESCRIPTION</A></H1>
<P>
The Spreadsheet::WriteExcel module can be used to create a cross-platform
Excel binary file. Multiple worksheets can be added to a workbook and
formatting can be applied to cells. Text, numbers, formulas and hyperlinks
can be written to the cells.

</P>
<P>
The Excel file produced by this module is compatible with Excel 5, 95, 97
and 2000.

</P>
<P>
The module will work on the majority of Windows, UNIX and Macintosh
platforms. Generated files are also compatible with the Linux/UNIX
spreadsheet applications OpenOffice, Gnumeric and XESS. The generated files
are not compatible with MS Access.

</P>
<P>
<HR>
<H1><A NAME="WORKBOOK_METHODS">WORKBOOK METHODS</A></H1>
<P>
The Spreadsheet::WriteExcel module provides an object oriented interface to
a new Excel workbook. The following methods are available through a new
workbook.

</P>
<P>
If you are unfamiliar with object oriented interfaces or the way that they
are implemented in Perl have a look at <CODE>perlobj</CODE> and <CODE>perltoot</CODE> in the main Perl documentation.

</P>
<P>
<HR>
<H2><A NAME="new_">new()</A></H2>
<P>
A new Excel workbook is created using the <CODE>new()</CODE> constructor which accepts either a filename or a filehandle as a parameter.
The following example creates a new Excel file based on a filename:

</P>
<P>
<PRE>
    my $workbook  = Spreadsheet::WriteExcel-&gt;new('filename.xls');
    my $worksheet = $workbook-&gt;addworksheet();
    $worksheet-&gt;write(0, 0,  &quot;Hi Excel!&quot;);
</PRE>
</P>
<P>
Here are some other examples of using <CODE>new()</CODE> with filenames:

</P>
<P>
<PRE>
    my $workbook1 = Spreadsheet::WriteExcel-&gt;new($filename);
    my $workbook2 = Spreadsheet::WriteExcel-&gt;new(&quot;/tmp/filename.xls&quot;);
    my $workbook3 = Spreadsheet::WriteExcel-&gt;new(&quot;c:\\tmp\\filename.xls&quot;);
    my $workbook4 = Spreadsheet::WriteExcel-&gt;new('c:\tmp\filename.xls');
</PRE>
</P>
<P>
The last two examples demonstrates how to create a file on DOS or Windows
where it is necessary to either escape the directory separator <CODE>\</CODE> or to use single quotes to ensure that it isn't interpolated. For more
information see <CODE>perlfaq5: Why can't I use &quot;C:\temp\foo&quot; in DOS paths?</CODE>.

</P>
<P>
The <CODE>new()</CODE> constructor returns a Spreadsheet::WriteExcel object that you can use to
add worksheets and store data. It should be noted that although <CODE>my</CODE> is not specifically required it defines the scope of the new workbook
variable and, in the majority of cases, ensures that the workbook is closed
properly without explicitly calling the <CODE>close()</CODE> method.

</P>
<P>
You can also pass a valid filehandle to the <CODE>new()</CODE> constructor. For example in a CGI program you could do something like this:

</P>
<P>
<PRE>
    binmode(STDOUT);
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(\*STDOUT);
</PRE>
</P>
<P>
The requirement for <CODE>binmode()</CODE> is explained below.

</P>
<P>
For CGI programs you can also use the special Perl filename <CODE>'-'</CODE> which will redirect the output to STDOUT:

</P>
<P>
<PRE>
    my $workbook  = Spreadsheet::WriteExcel-&gt;new('-');
</PRE>
</P>
<P>
See also, the <CODE>cgi.pl</CODE> program in the <CODE>examples</CODE> directory of the distro. However, this special case will not work in <CODE>mod_perl</CODE> programs where you will have to do something like the following:

</P>
<P>
<PRE>
    tie *XLS, 'Apache';
    binmode(XLS);
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(\*XLS);
</PRE>
</P>
<P>
Filehandles can also be useful if you want to stream an Excel file over a
socket or if you want to store an Excel file in a tied scalar. For some
examples of using filehandles with Spreadsheet::WriteExcel see the <CODE>filehandle.pl</CODE> program in the <CODE>examples</CODE> directory of the distro.

</P>
<P>
Note about the requirement for <CODE>binmode()</CODE>: An Excel file is comprised of binary data. Therefore, if you are using a
filehandle you should ensure that you <CODE>binmode()</CODE> it prior to passing it to <CODE>new()</CODE>.You should do this regardless of whether your platform requires it or not.
For more information about <CODE>binmode()</CODE> see <CODE>perlfunc</CODE> and <CODE>perlopentut</CODE> in the main Perl documentation. It is equally important to note that you do
not need to <CODE>binmode()</CODE> a filename. In fact it would cause an error. Spreadsheet::WriteExcel
performs the <CODE>binmode()</CODE> internally when it converts the filename to a filehandle.

</P>
<P>
<HR>
<H2><A NAME="close_">close()</A></H2>
<P>
The <CODE>close()</CODE> method can be used to explicitly close an Excel file.

</P>
<P>
<PRE>
    $workbook-&gt;close();
</PRE>
</P>
<P>
An explicit <CODE>close()</CODE> is required if the file must be closed prior to performing some external
action on it such as copying or reading its size.

</P>
<P>
In addition, <CODE>close()</CODE> may be required if the scope of the Workbook, Worksheet or Format objects
cannot be determined by perl. Situations where this can occur are:

</P>
<UL>
<LI><A NAME="item_If">If my() was not used to declare the scope of a workbook variable created using new().</A>
<LI><A NAME="item_If">If the addworksheet() or addformat() methods are called in subroutines.</A>
</UL>
<P>
The reason for this is that Spreadsheet::WriteExcel relies on Perl's <CODE>DESTROY</CODE> mechanism to trigger destructor methods in a specific sequence. This will
not happen if the scope of the variables cannot be determined.

</P>
<P>
In general, if you create a file with a size of 0 bytes you need to call <CODE>close()</CODE>.

</P>
<P>
<HR>
<H2><A NAME="addworksheet_sheetname_">addworksheet($sheetname)</A></H2>
<P>
At least one worksheet should be added to a new workbook. A worksheet is
used to write data into cells:

</P>
<P>
<PRE>
    $worksheet1 = $workbook-&gt;addworksheet();          # Sheet1
    $worksheet2 = $workbook-&gt;addworksheet('Foglio2'); # Foglio2
    $worksheet3 = $workbook-&gt;addworksheet('Data');    # Data
    $worksheet4 = $workbook-&gt;addworksheet();          # Sheet4
</PRE>
</P>
<P>
If <CODE>$sheetname</CODE> is not specified the default Excel convention will be followed, i.e.
Sheet1, Sheet2, etc.

</P>
<P>
<HR>
<H2><A NAME="addformat_">addformat()</A></H2>
<P>
The <CODE>addformat()</CODE> method can be used to create new Format objects which are used to apply
formatting to a cell:

</P>
<P>
<PRE>
    $format1 = $workbook-&gt;addformat();
    $format2 = $workbook-&gt;addformat();
</PRE>
</P>
<P>
See the <A HREF="#FORMAT_METHODS">FORMAT METHODS</A> section for details.

</P>
<P>
<HR>
<H2><A NAME="worksheets_">worksheets()</A></H2>
<P>
The <CODE>worksheets()</CODE> method returns a reference to the array of worksheets in a workbook. This
can be useful if you want to repeat an operation on each worksheet in a
workbook or if you wish to refer to a worksheet by its index:

</P>
<P>
<PRE>
    foreach $worksheet (@{$workbook-&gt;worksheets()}) {
       $worksheet-&gt;write(0, 0, &quot;Hello&quot;);
    }
</PRE>
</P>
<P>
<PRE>
    # or:
</PRE>
</P>
<P>
<PRE>
    $worksheets = $workbook-&gt;worksheets();
    @$worksheets[0]-&gt;write(0, 0, &quot;Hello&quot;);
</PRE>
</P>
<P>
References are explained in detail in <CODE>perlref</CODE> and <CODE>perlreftut</CODE> in the main Perl documentation.

</P>
<P>
<HR>
<H2><A NAME="set_1904_">set_1904()</A></H2>
<P>
Excel stores dates as real numbers where the integer part stores the number
of days since the epoch and the fractional part stores the percentage of
the day. The epoch can be either 1900 or 1904. Excel for Windows uses 1900
and Excel for Macintosh uses 1904. However, Excel on either platform will
convert automatically between one system and the other.

</P>
<P>
Spreadsheet::WriteExcel stores dates in the 1900 format by default. If you
wish to change this you can call the <CODE>set_1904()</CODE> workbook method. You can query the current value by calling the <CODE>get_1904()</CODE> workbook method. This returns 0 for 1900 and 1 for 1904.

</P>
<P>
In general you probably won't need to use <CODE>set_1904()</CODE>.

</P>
<P>
<HR>
<H1><A NAME="WORKSHEET_METHODS">WORKSHEET METHODS</A></H1>
<P>
The following methods are available through a new worksheet. A new
worksheet is created by calling the <CODE>addworksheet()</CODE> method from a workbook object:

</P>
<P>
<PRE>
    $worksheet1 = $workbook-&gt;addworksheet();
    $worksheet2 = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<HR>
<H2><A NAME="Cell_notation">Cell notation</A></H2>
<P>
Spreadsheet::WriteExcel supports two forms of notation to designate the
position of cells: Row-column notation and A1 notation.

</P>
<P>
Row-column notation uses a zero based index for both row and column while
A1 notation uses the standard Excel alphanumeric sequence of column letter
and 1-based row. For example:

</P>
<P>
<PRE>
    (0, 0)      # The top left cell in row-column notation.
    ('A1')      # The top left cell in A1 notation.
</PRE>
</P>
<P>
<PRE>
    (1999, 29)  # Row-column notation.
    ('AD2000')  # The same cell in A1 notation.
</PRE>
</P>
<P>
Row-column notation is useful if you are referring to cells
programmatically:

</P>
<P>
<PRE>
    for my $i (0 .. 9) {
        $worksheet-&gt;write($i, 0, 'Hello'); # Cells A1 to A10
    }
</PRE>
</P>
<P>
A1 notation is useful for setting up a worksheet manually and for working
with formulas:

</P>
<P>
<PRE>
    $worksheet-&gt;write('H1', 200);
    $worksheet-&gt;write('H2', '=H7+1');
</PRE>
</P>
<P>
In the <CODE>examples</CODE> directory of the distro there is a program called <CODE>convertA1.pl</CODE> which contains helper functions for dealing with A1 notation.

</P>
<P>
For simplicity, the parameter lists for the worksheet method calls in the
following sections are given in terms of row-column notation. In all cases
it is also possible to use A1 notation.

</P>
<P>
<HR>
<H2><A NAME="write_row_column_token_fo">write($row, $column, $token, $format)</A></H2>
<P>
The <CODE>write()</CODE> method is a general alias for one of several methods of writing to a cell
in Excel. <CODE>write()</CODE> calls one of the following methods depending on the value of <CODE>$token</CODE>:

</P>
<P>
<CODE>write_number()</CODE> if <CODE>$token</CODE> is a number based on the following regex: <CODE>$token =~ /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/</CODE>.

</P>
<P>
<CODE>write_blank()</CODE> if <CODE>$token</CODE> is a blank string: <CODE>&quot;&quot;</CODE> or <CODE>''</CODE>.

</P>
<P>
<CODE>write_url()</CODE> if <CODE>$token</CODE> is a http, ftp or mailto URL based on the following regexes: <CODE>$token =~ m|^[fh]tt?p://|</CODE> or  <CODE>$token =~ m|^mailto:|</CODE>.

</P>
<P>
<CODE>write_formula()</CODE> if the first character of <CODE>$token</CODE> is <CODE>&quot;=&quot;</CODE>.

</P>
<P>
<CODE>write_string()</CODE> if none of the previous conditions apply.

</P>
<P>
Here are some examples in both row-column and A1 notation:

</P>
<P>
<PRE>
    $worksheet-&gt;write(0, 0, &quot;Hello&quot;                 );  # write_string()
    $worksheet-&gt;write('A2', 'One'                   );  # write_string()
    $worksheet-&gt;write(2, 0,  2                      );  # write_number()
    $worksheet-&gt;write('A4',  3.00001                );  # write_number()
    $worksheet-&gt;write(4, 0,  &quot;&quot;                     );  # write_blank()
    $worksheet-&gt;write('A6',  ''                     );  # write_blank()
    $worksheet-&gt;write(6, 0,  'http://www.perl.com/' );  # write_url()
    $worksheet-&gt;write('A8',  'ftp://ftp.cpan.org/'  );  # write_url()
    $worksheet-&gt;write(8, 0,  '=A3 + 3*A4'           );  # write_formula()
    $worksheet-&gt;write('A10', '=SIN(PI()/4)'         );  # write_formula()
</PRE>
</P>
<P>
The <CODE>$format</CODE> argument is optional. It should be a valid Format object, see <A HREF="#FORMAT_METHODS">FORMAT METHODS</A>:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_bold();
    $format-&gt;set_color('red');
    $format-&gt;set_align('center');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(4, 0, &quot;Hello&quot;, $format ); # Formatted string
</PRE>
</P>
<P>
The <CODE>write</CODE> methods return:

</P>
<P>
<PRE>
    0 for success.
   -1 for insufficient number of arguments.
   -2 for row or column out of bounds.
   -3 for string too long.
</PRE>
</P>
<P>
<HR>
<H2><A NAME="write_number_row_column_num">write_number($row, $column, $number, $format)</A></H2>
<P>
Write an integer or a float to the cell specified by <CODE>$row</CODE> and <CODE>$column</CODE>:

</P>
<P>
<PRE>
    $worksheet-&gt;write_number(0, 0,  1     );
    $worksheet-&gt;write_number('A2',  2.3451);
</PRE>
</P>
<P>
See the note about <A HREF="#Cell_notation">Cell notation</A>. The <CODE>$format</CODE> argument is optional.

</P>
<P>
<HR>
<H2><A NAME="write_string_row_column_str">write_string($row, $column, $string, $format)</A></H2>
<P>
Write a string to the cell specified by <CODE>$row</CODE> and <CODE>$column</CODE>:

</P>
<P>
<PRE>
    $worksheet-&gt;write_string(0, 0, &quot;Your text here&quot; );
    $worksheet-&gt;write_string('A2', &quot;or here&quot; );
</PRE>
</P>
<P>
See the note about <A HREF="#Cell_notation">Cell notation</A>. The maximum string size is 255 characters. The <CODE>$format</CODE> argument is optional.

</P>
<P>
<HR>
<H2><A NAME="write_formula_row_column_fo">write_formula($row, $column, $formula, $format)</A></H2>
<P>
Write a formula or function to the cell specified by <CODE>$row</CODE> and <CODE>$column</CODE>:

</P>
<P>
<PRE>
    $worksheet-&gt;write_formula(0, 0, '=$B$3 + B4'  );
    $worksheet-&gt;write_formula(1, 0, '=SIN(PI()/4)');
    $worksheet-&gt;write_formula(2, 0, '=SUM(B1:B5)' );
    $worksheet-&gt;write_formula('A4', '=IF(A3&gt;1,&quot;Yes&quot;, &quot;No&quot;)'   );
    $worksheet-&gt;write_formula('A5', '=AVERAGE(1, 2, 3, 4)'    );
    $worksheet-&gt;write_formula('A6', '=DATEVALUE(&quot;1-Jan-2001&quot;)');
</PRE>
</P>
<P>
See the note about <A HREF="#Cell_notation">Cell notation</A>. For more information about writing Excel formulas see <A HREF="#FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL</A>



</P>
<P>
<HR>
<H2><A NAME="write_blank_row_column_form">write_blank($row, $column, $format)</A></H2>
<P>
Write a blank cell specified by <CODE>$row</CODE> and <CODE>$column</CODE>:

</P>
<P>
<PRE>
    $worksheet-&gt;write_blank(0, 0, $format);
</PRE>
</P>
<P>
See the note about <A HREF="#Cell_notation">Cell notation</A>. This method is useful for adding formatting to a cell which doesn't
contain a string or number value.

</P>
<P>
<HR>
<H2><A NAME="write_url_row_col_url_str">write_url($row, $col, $url, $string, $format)</A></H2>
<P>
Write a hyperlink to a URL in the cell specified by <CODE>$row</CODE> and <CODE>$column</CODE>. The hyperlink is comprised of two elements: the visible label and the
invisible link. The visible label is the same as the link unless an
alternative string is specified. The alternative <CODE>$string</CODE> and the <CODE>$format</CODE> are optional.

</P>
<P>
<PRE>
    $worksheet-&gt;write_url(0, 0, '<A HREF="http://www.perl.com/">http://www.perl.com/</A>'                );
    $worksheet-&gt;write_url(1, 0, '<A HREF="http://www.perl.com/">http://www.perl.com/</A>', 'Perl home'   );
    $worksheet-&gt;write_url(2, 0, '<A HREF="http://www.perl.com/">http://www.perl.com/</A>', undef, $format);
    $worksheet-&gt;write_url(3, 0, '<A HREF="mailto:jmcnamara@cpan.org">mailto:jmcnamara@cpan.org</A>'           );
</PRE>
</P>
<P>
The label is written using the <CODE>write_string()</CODE> method. Therefore the 255 characters string limit applies to the label: the
URL can be any length. Use <CODE>undef</CODE> if you wish to specify a format without specifying an alternative
string.See the note about <A HREF="#Cell_notation">Cell notation</A>.

</P>
<P>
Note: Hyperlinks are not available in Excel 5. They will appear as a string
only.

</P>
<P>
<HR>
<H2><A NAME="activate_">activate()</A></H2>
<P>
The <CODE>activate()</CODE> method is used to specify which worksheet is initially visible in a
multi-sheet workbook:

</P>
<P>
<PRE>
    $worksheet1 = $workbook-&gt;addworksheet('To');
    $worksheet2 = $workbook-&gt;addworksheet('the');
    $worksheet3 = $workbook-&gt;addworksheet('wind');
</PRE>
</P>
<P>
<PRE>
    $worksheet3-&gt;activate();
</PRE>
</P>
<P>
This is similar to the Excel VBA activate method. More than one worksheet
can be selected via the <CODE>select()</CODE> method, however only one worksheet can be active. The default value is the
first worksheet.

</P>
<P>
<HR>
<H2><A NAME="select_">select()</A></H2>
<P>
The <CODE>select()</CODE> method is used to indicate that a worksheet is selected in a multi-sheet
workbook:

</P>
<P>
<PRE>
    $worksheet1-&gt;activate();
    $worksheet2-&gt;select();
    $worksheet3-&gt;select();
</PRE>
</P>
<P>
A selected worksheet has its tab highlighted. Selecting worksheets is a way
of grouping them together so that, for example, several worksheets could be
printed in one go.. A worksheet that has been activated via the <CODE>activate()</CODE> method will also appear as a selected. You probably won't need to use the <CODE>select()</CODE> method very often.

</P>
<P>
<HR>
<H2><A NAME="set_first_sheet_">set_first_sheet()</A></H2>
<P>
The <CODE>activate()</CODE> method determines which worksheet is initially selected. However, if there
are a large number of worksheets the selected worksheet may not appear on
the screen. To avoid this you can select which is the leftmost visible
worksheet using <CODE>set_first_sheet()</CODE>:

</P>
<P>
<PRE>
    for (1..20) {
        $workbook-&gt;addworksheet;
    }
</PRE>
</P>
<P>
<PRE>
    $worksheet21 = $workbook-&gt;addworksheet();
    $worksheet22 = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<PRE>
    $worksheet21-&gt;set_first_sheet();
    $worksheet22-&gt;activate();
</PRE>
</P>
<P>
This method is not required very often. The default value is the first
worksheet.

</P>
<P>
<HR>
<H2><A NAME="set_selection_first_row_first">set_selection($first_row, $first_col, $last_row, $last_col);</A></H2>
<P>
This method can be used to specify which cell or cells are selected in a
worksheet. The most common requirement is to select a single cell, in which
case <CODE>$last_row</CODE> and <CODE>$last_col</CODE> are not required. The active cell within a selected range is determined by
the order in which <CODE>$first</CODE> and <CODE>$last</CODE> are specified. It is also possible to specify a cell or a range using A1
notation. See the note about <A HREF="#Cell_notation">Cell notation</A>.

</P>
<P>
Examples:

</P>
<P>
<PRE>
    $worksheet1-&gt;set_selection(3, 3);       # 1. Cell D4.
    $worksheet2-&gt;set_selection(3, 3, 6, 6); # 2. Cells D4 to G7.
    $worksheet3-&gt;set_selection(6, 6, 3, 3); # 3. Cells G7 to D4.
    $worksheet4-&gt;set_selection('D4');       # Same as 1.
    $worksheet5-&gt;set_selection('D4:G7');    # Same as 2.
    $worksheet6-&gt;set_selection('G7:D4');    # Same as 3.
</PRE>
</P>
<P>
The default cell is (0, 0), 'A1'.

</P>
<P>
<HR>
<H2><A NAME="set_row_row_height_format_">set_row($row, $height, $format);</A></H2>
<P>
This method can be used to specify the height of a row. The <CODE>$format</CODE> argument is optional, for additional information, see <A HREF="#FORMAT_METHODS">FORMAT METHODS</A>.

</P>
<P>
<PRE>
    $worksheet-&gt;set_row(0, 20); # Row 1 height set to 20
</PRE>
</P>
<P>
If you wish to set the format without changing the height you can pass <CODE>undef</CODE> as the height parameter:

</P>
<P>
<PRE>
    $worksheet-&gt;set_row(0, undef, $format);
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_column_first_col_last_col">set_column($first_col, $last_col, $width, $format);</A></H2>
<P>
This method can be used to specify the width of a single column or a range
of columns. If the method is applied to a single column the value of <CODE>$first_col</CODE> and <CODE>$last_col</CODE> should be the same. It is also possible to specify a column range using the
form of A1 notation used for columns. See the note about <A HREF="#Cell_notation">Cell notation</A>.

</P>
<P>
Examples:

</P>
<P>
<PRE>
    $worksheet-&gt;set_column(0, 0,  20); # Column  A   width set to 20
    $worksheet-&gt;set_column(1, 3,  30); # Columns B-D width set to 30
    $worksheet-&gt;set_column('E:E', 20); # Column  E   width set to 20
    $worksheet-&gt;set_column('F:H', 30); # Columns F-H width set to 30
</PRE>
</P>
<P>
The width corresponds to the column width value that is specified in Excel.
It is approximately equal to the length of a string in the default font of
Arial 10. The <CODE>$format</CODE> argument is optional, for additional information, see <A HREF="#FORMAT_METHODS">FORMAT METHODS</A>.

</P>
<P>
If you wish to set the format without changing the width you can pass <CODE>undef</CODE> as the width parameter:

</P>
<P>
<PRE>
    $worksheet-&gt;set_column(0, 0, undef, $format);
</PRE>
</P>
<P>
Unfortunately, there is no way to specify &quot;AutoFit&quot; for a column
in the Excel file format. This feature is only available at runtime from
within Excel.

</P>
<P>
<HR>
<H2><A NAME="freeze_panes_row_col_top_ro">freeze_panes($row, $col, $top_row, $left_col);</A></H2>
<P>
This method can be used to divide a worksheet into horizontal or vertical
regions known as panes and to also &quot;freeze&quot; these panes so that
the splitter bars are not visible. This is the the same as the
&quot;Window-&gt;Freeze Panes&quot; menu command in Excel

</P>
<P>
The parameters <CODE>$row</CODE> and <CODE>$col</CODE> are used to specify the location of the split. It should be noted that the
split is specified at the top or left of a cell and that the method uses
zero based indexing. Therefore to freeze the first row of a worksheet it is
necessary to specify the split at row 2 (which is 1 as the zero-based
index). This might lead you to think that you are using a 1 based index but
this is not the case.

</P>
<P>
You can set one of the <CODE>$row</CODE> and <CODE>$col</CODE> parameters as zero if you do not want either a vertical or horizontal
split. 

</P>
<P>
Examples:

</P>
<P>
<PRE>
    $worksheet-&gt;freeze_panes(1, 0); # Freeze the first row
    $worksheet-&gt;freeze_panes('A2'); # Same using A1 notation
    $worksheet-&gt;freeze_panes(0, 1); # Freeze the first column
    $worksheet-&gt;freeze_panes('B1'); # Same using A1 notation
    $worksheet-&gt;freeze_panes(1, 2); # Freeze the first row and first 2 columns
    $worksheet-&gt;freeze_panes('C2'); # Same using A1 notation
</PRE>
</P>
<P>
The parameters <CODE>$top_row</CODE> and <CODE>$left_col</CODE> are optional. They are used to specify the top-most or left-most visible
row or column in the scrolling region of the panes. For example to freeze
the first row and to have the scrolling region begin at row twenty:

</P>
<P>
<PRE>
    $worksheet-&gt;freeze_panes(1, 0, 20, 0);
</PRE>
</P>
<P>
You cannot use A1 notation for the <CODE>$top_row</CODE> and <CODE>$left_col</CODE> parameters.
    

</P>
<P>
See also the <CODE>panes.pl</CODE> program in the examples directory of the distribution.

</P>
<P>
<HR>
<H2><A NAME="thaw_panes_y_x_top_row_le">thaw_panes($y, $x, $top_row, $left_col);</A></H2>
<P>
This method can be used to divide a worksheet into horizontal or vertical
regions known as panes. This method is different from the <CODE>freeze_panes()</CODE> method in that the splits between the panes will be visible to the user and
each pane will have its own scroll bars.

</P>
<P>
The parameters <CODE>$y</CODE> and <CODE>$x</CODE> are used to specify the vertical and horizontal position of the split. The
units for <CODE>$y</CODE> and <CODE>$x</CODE> are the same as those used by Excel to specify row height and column width.
However, the vertical and horizontal units are different from each other.
Therefore you must specify the <CODE>$y</CODE> and <CODE>$x</CODE> parameters in terms of the row heights and column widths that you have set
or the default values which are <CODE>12.75</CODE> for a row and  <CODE>8.43</CODE> for a column.

</P>
<P>
You can set one of the <CODE>$y</CODE> and <CODE>$x</CODE> parameters as zero if you do not want either a vertical or horizontal
split. The parameters <CODE>$top_row</CODE> and <CODE>$left_col</CODE> are optional. They are used to specify the top-most or left-most visible
row or column in the bottom-right pane.

</P>
<P>
Example:

</P>
<P>
<PRE>
    $worksheet-&gt;thaw_panes(12.75, 0,    1, 0); # First row
    $worksheet-&gt;thaw_panes(0,     8.43, 0, 1); # First column
    $worksheet-&gt;thaw_panes(12.75, 8.43, 1, 1); # First row and column
</PRE>
</P>
<P>
You cannot use A1 notation with this method.

</P>
<P>
See also the <CODE>freeze_panes()</CODE> method and the <CODE>panes.pl</CODE> program in the examples directory of the distribution.

</P>
<P>
<HR>
<H1><A NAME="PAGE_SETUP_METHODS">PAGE SETUP METHODS</A></H1>
<P>
Page setup methods affect the way that a worksheet will look when it is
printed. They control features such as page headers and footers and
margins. These methods are really just standard worksheet methods. They are
documented here in a separate section for the sake of clarity.

</P>
<P>
Not all of Excel's page setup options are available in this release but
they will be added in subsequent releases.

</P>
<P>
A common requirement when working with Spreadsheet::WriteExcel is to apply
the same page setup features to all of the worksheets in a workbook. To do
this you can use the the <CODE>worksheets()</CODE> method of the <CODE>workbook</CODE> class to access the array of worksheets in a workbook:

</P>
<P>
<PRE>
    foreach $worksheet (@{$workbook-&gt;worksheets()}) {
       $worksheet-&gt;$worksheet-&gt;set_orientation(0);
    }
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_landscape_">set_landscape()</A></H2>
<P>
This method is used to set the orientation of a worksheet's printed page to
landscape:

</P>
<P>
<PRE>
    $worksheet-&gt;set_orientation(); # Landscape mode
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_portrait_">set_portrait()</A></H2>
<P>
This method is used to set the orientation of a worksheet's printed page to
portrait. The default worksheet orientation is portrait, so you generally
won't need to call this method.

</P>
<P>
<PRE>
    $worksheet-&gt;set_portrait(); # Portrait mode
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_paper_index_">set_paper($index)</A></H2>
<P>
This method is used to set the paper format for the printed output of a
worksheet. The following paper styles are available:

</P>
<P>
<PRE>
    Index   Paper format            Paper size
    =====   ============            ==========
      0     Printer default         -
      1     Letter                  8 1/2 x 11 in
      2     Letter Small            8 1/2 x 11 in
      3     Tabloid                 11 x 17 in
      4     Ledger                  17 x 11 in
      5     Legal                   8 1/2 x 14 in
      6     Statement               5 1/2 x 8 1/2 in
      7     Executive               7 1/4 x 10 1/2 in
      8     A3                      297 x 420 mm
      9     A4                      210 x 297 mm
     10     A4 Small                210 x 297 mm
     11     A5                      148 x 210 mm
     12     B4                      250 x 354 mm
     13     B5                      182 x 257 mm
     14     Folio                   8 1/2 x 13 in
     15     Quarto                  215 x 275 mm
     16     -                       10x14 in
     17     -                       11x17 in
     18     Note                    8 1/2 x 11 in
     19     Envelope  9             3 7/8 x 8 7/8
     20     Envelope 10             4 1/8 x 9 1/2
     21     Envelope 11             4 1/2 x 10 3/8
     22     Envelope 12             4 3/4 x 11
     23     Envelope 14             5 x 11 1/2
     24     C size sheet            -
     25     D size sheet            -
     26     E size sheet            -
     27     Envelope DL             110 x 220 mm
     28     Envelope C3             324 x 458 mm
     29     Envelope C4             229 x 324 mm
     30     Envelope C5             162 x 229 mm
     31     Envelope C6             114 x 162 mm
     32     Envelope C65            114 x 229 mm
     33     Envelope B4             250 x 353 mm
     34     Envelope B5             176 x 250 mm
     35     Envelope B6             176 x 125 mm
     36     Envelope                110 x 230 mm
     37     Monarch                 3.875 x 7.5 in
     38     Envelope                3 5/8 x 6 1/2 in
     39     Fanfold                 14 7/8 x 11 in
     40     German Std Fanfold      8 1/2 x 12 in
     41     German Legal Fanfold    8 1/2 x 13 in
</PRE>
</P>
<P>
Note, it is likely that not all of these paper types will be available to
the end user since it will depend on the paper formats that the user's
printer supports. Therefore, it is best to stick to standard paper types.

</P>
<P>
If you do not specify a paper type the worksheet will print using the
printer's default paper. 

</P>
<P>
<PRE>
    $worksheet-&gt;set_paper(1); # US Letter
    $worksheet-&gt;set_paper(9); # A4
</PRE>
</P>
<P>
<HR>
<H2><A NAME="center_horizontally_">center_horizontally()</A></H2>
<P>
Center the worksheet data horizontally between the margins on the printed
page:

</P>
<P>
<PRE>
    $worksheet-&gt;center_horizontally();
</PRE>
</P>
<P>
<HR>
<H2><A NAME="center_vertically_">center_vertically()</A></H2>
<P>
Center the worksheet data vertically between the margins on the printed
page:

</P>
<P>
<PRE>
    $worksheet-&gt;center_vertically();
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_margins_inches_">set_margins($inches)</A></H2>
<P>
There are several methods available for setting the worksheet margins on
the printed page:

</P>
<P>
<PRE>
    set_margins()        # Set all margins to the same value
    set_margins_LR()     # Set left and right margins to the same value
    set_margins_TB()     # Set top and bottom margins to the same value
    set_margin_left();   # Set left margin
    set_margin_right();  # Set right margin
    set_margin_top();    # Set top margin
    set_margin_bottom(); # Set bottom margin
</PRE>
</P>
<P>
All of these methods take a distance in inches as a parameter. Note: 1 inch
= 25.4mm. ;-) The default left and right margin is 0.75 inch. The default
top and bottom margin is 1.00 inch. 

</P>
<P>
<HR>
<H2><A NAME="set_header_string_margin_">set_header($string, $margin)</A></H2>
<P>
Headers and footers are generated using a <CODE>$string</CODE> which is a combination of plain text and control characters. The <CODE>$margin</CODE> parameter is optional.

</P>
<P>
The available control character are:

</P>
<P>
<PRE>
    Control              Type             Description
    =======              ====             ===========
    &amp;L                   Justification    Left
    &amp;C                                    Center
    &amp;R                                    Right
    
    &amp;P                   Information      Page number
    &amp;N                                    Total number of pages
    &amp;D                                    Date
    &amp;T                                    Time
    &amp;F                                    File name
    &amp;A                                    Worksheet name
    
    &amp;fontsize            Font             Font size
    &amp;&quot;fontname,style&quot;                     Font name and style
    
    
</PRE>
</P>
<P>
Text in headers and footers can be justified (aligned) to the left, center
and right by prefixing the text with the control characters <CODE>&amp;L</CODE>, <CODE>&amp;C</CODE> and <CODE>&amp;R</CODE>.

</P>
<P>
For example (with ASCII art representation of the results):

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('&amp;LHello');
    
     ---------------------------------------------------------------
    |                                                               |
    | Hello                                                         |
    |                                                               |
    
    
    $worksheet-&gt;set_header('&amp;CHello');
    
     ---------------------------------------------------------------
    |                                                               |
    |                          Hello                                |
    |                                                               |
    
    
    $worksheet-&gt;set_header('&amp;RHello');
    
     ---------------------------------------------------------------
    |                                                               |
    |                                                         Hello |
    |                                                               |
    
</PRE>
</P>
<P>
If you do not specify any justification the text will be centered:

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('Hello');
    
     ---------------------------------------------------------------
    |                                                               |
    |                          Hello                                |
    |                                                               |
    
</PRE>
</P>
<P>
You can also have text in each of the justification regions:

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('&amp;LCiao&amp;CBello&amp;RCielo');
    
     ---------------------------------------------------------------
    |                                                               |
    | Ciao                     Bello                          Cielo |
    |                                                               |
    
</PRE>
</P>
<P>
The information control characters act as variables that Excel will update
as the workbook or worksheet changes. Times and dates are in the users
default format:

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('Page &amp;P of &amp;N');
    
     ---------------------------------------------------------------
    |                                                               |
    |                        Page 1 of 6                            |
    |                                                               |
    
    
    $worksheet-&gt;set_header('Updated at &amp;T');
    
     ---------------------------------------------------------------
    |                                                               |
    |                    Updated at 12:30 PM                        |
    |                                                               |
    
</PRE>
</P>
<P>
You can specify the font size of a section of the text by prefixing it with
the control character <CODE>&amp;n</CODE> where <CODE>n</CODE> is the font size:

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('&amp;20Big Hello');
    $worksheet-&gt;set_header('&amp;6Small Hello');
</PRE>
</P>
<P>
You can specify the font of a section of the text by prefixing it with the
control sequence <CODE>&amp;&quot;fontname,style&quot;</CODE> where <CODE>fontname</CODE> is a font name such as &quot;Courier New&quot; or &quot;Times New
Roman&quot; and <CODE>style</CODE> is one of the standard Windows font descriptions: &quot;Regular&quot;,
&quot;Italic&quot;, &quot;Bold&quot; or &quot;Bold Italic&quot;:

</P>
<P>
<PRE>
    $worksheet1-&gt;set_header('&amp;&quot;Courier New,Italic&quot;Hello');
    $worksheet2-&gt;set_header('&amp;&quot;Courier New,Bold Italic&quot;Hello');
    $worksheet3-&gt;set_header('&amp;&quot;Times New Roman,Regular&quot;Hello');
</PRE>
</P>
<P>
It is possible to combine all of these features together to create
sophisticated headers and footers. As an aid to setting up complicated
headers and footers you can record a page setup as a macro in Excel and
look at the format strings that VBA produces. Remember however that VBA
uses a double double quote <CODE>&quot;&quot;</CODE> to indicate a single double quote. For the last example above the
equivalent VBA code looks like this:

</P>
<P>
<PRE>
    .LeftHeader   = &quot;&quot;
    .CenterHeader = &quot;&amp;&quot;&quot;Times New Roman,Regular&quot;&quot;Hello&quot;
    .RightHeader  = &quot;&quot;
</PRE>
</P>
<P>
The header or footer string must be less than 255 characters.

</P>
<P>
As stated above the margin parameter is optional. As with the other margins
the value should be in inches. The default header and footer margin is 0.50
inch. The header and footer margin size can be set as follows:

</P>
<P>
<PRE>
    $worksheet-&gt;set_header('&amp;CHello', 0.75);
</PRE>
</P>
<P>
Note, the header and footer margins are independent of the top and bottom
margins.

</P>
<P>
<HR>
<H2><A NAME="set_footer_">set_footer()</A></H2>
<P>
See the <CODE>set_header()</CODE> section above.

</P>
<P>
<HR>
<H1><A NAME="FORMAT_METHODS">FORMAT METHODS</A></H1>
<P>
This section describes the methods that are available through a Format
object. Format objects are created by calling the workbook <CODE>addformat()</CODE> method as follows:

</P>
<P>
<PRE>
    my $heading1 = $workbook-&gt;addformat();
    my $heading2 = $workbook-&gt;addformat();
</PRE>
</P>
<P>
The format object holds all the formatting properties that can be applied
to a cell, a row or a column. The following table shows the Excel format
categories, the formatting properties that can be applied and the relevant
object method to do so:

</P>
<P>
<PRE>
    Category        Property            Method Name
    --------        --------            -----------
    Font            Font type           set_font()
                    Font size           set_size()
                    Font color          set_color()
                    Bold                set_bold()
                    Italic              set_italic()
                    Underline           set_underline()
                    Strikeout           set_font_strikeout()
                    Super/Subscript     set_font_script()
                    Outline             set_font_outline()
                    Shadow              set_font_shadow()
</PRE>
</P>
<P>
<PRE>
    Number          Numeric format      set_num_format()
</PRE>
</P>
<P>
<PRE>
    Alignment       Horizontal align    set_align()
                    Vertical align      set_align()
                    Rotation            set_rotation()
                    Text wrap           set_text_wrap()
                    Justify last        set_text_justlast()
                    Merge               set_merge()
</PRE>
</P>
<P>
<PRE>
    Pattern         Cell pattern        set_pattern()
                    Background color    set_bg_color()
                    Foreground color    set_fg_color()
</PRE>
</P>
<P>
<PRE>
    Border          Cell border         set_border()
                    Bottom border       set_bottom()
                    Top border          set_top()
                    Left border         set_left()
                    Right border        set_right()
                    Border color        set_border_color()
                    Bottom color        set_bottom_color()
                    Top color           set_top_color()
                    Left color          set_left_color()
                    Right color         set_right_color()
</PRE>
</P>
<P>
The default format is Arial 10 with all other properties off. In general a
method call without an argument will turn a property on, for example:

</P>
<P>
<PRE>
    my $format1 = $workbook-&gt;addformat();
    $format1-&gt;set_bold();  # Turns bold on
    $format1-&gt;set_bold(1); # Also turns bold on
    $format1-&gt;set_bold(0); # Turns bold off
</PRE>
</P>
<P>
More than one property can be applied to a format:

</P>
<P>
<PRE>
    my $format2 = $workbook-&gt;addformat();
    $format2-&gt;set_bold();
    $format2-&gt;set_italic();
    $format2-&gt;set_color('red');
</PRE>
</P>
<P>
Once a Format object has been constructed it can be passed as an argument
to the worksheet <CODE>write</CODE> methods as follows:

</P>
<P>
<PRE>
    $worksheet-&gt;write(0, 0, &quot;One&quot;, $format);
    $worksheet-&gt;write_string(1, 0, &quot;Two&quot;, $format);
    $worksheet-&gt;write_number(2, 0, 3, $format);
    $worksheet-&gt;write_blank(3, 0, $format);
</PRE>
</P>
<P>
Formats can also be passed to the worksheet <CODE>set_row()</CODE> and <CODE>set_column()</CODE> methods to define the default property for a row or column.

</P>
<P>
<PRE>
    $worksheet-&gt;set_row(0, 15, $format);
    $worksheet-&gt;set_column(0, 0, 15, $format);
</PRE>
</P>
<P>
However, the <CODE>set_row()</CODE> and <CODE>set_column()</CODE> methods will not set the format for individual cells written by WriteExcel,
they only have an effect on cells written after the workbook is opened in
Excel.

</P>
<P>
It is important to understand that a Format is applied to a cell not in its
current state but in its final state. Consider the following example:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_bold();
    $format-&gt;set_color('red');
    $worksheet-&gt;write(0, 0, &quot;Cell A1&quot;, $format);
    $format-&gt;set_color('green');
    $worksheet-&gt;write(0, 1, &quot;Cell B1&quot;, $format);
</PRE>
</P>
<P>
Cell A1 is assigned the Format <CODE>$format</CODE> which is initially set to the colour red. However, the colour is
subsequently set to green. When Excel displays Cell A1 it will display the
final state of the Format which in this case will be the colour green.

</P>
<P>
The Format object methods are described in more detail in the following
sections. In addition, there is a Perl program called <CODE>formats.pl</CODE> in the <CODE>examples</CODE> directory of the WriteExcel distribution. This program creates an Excel
workbook called <CODE>formats.xls</CODE> which contains examples of almost all the format types.

</P>
<P>
<HR>
<H2><A NAME="copy_format_">copy($format)</A></H2>
<P>
This is the only method of a Format object that doesn't apply directly to a
property. It is used to copy all of the properties from one Format object
to another:

</P>
<P>
<PRE>
    my $lorry1 = $workbook-&gt;addformat();
    $lorry1-&gt;set_bold();
    $lorry1-&gt;set_italic();
    $lorry1-&gt;set_color('red');    # lorry1 is bold, italic and red
</PRE>
</P>
<P>
<PRE>
    my $lorry2 = $workbook-&gt;addformat();
    $lorry2-&gt;copy($lorry1);
    $lorry2-&gt;set_color('yellow'); # lorry2 is bold, italic and yellow
</PRE>
</P>
<P>
This can be useful when you are setting up several complex but similar
formats. It is also useful if you want to use a format in more than one
workbook:

</P>
<P>
<PRE>
    # Create the workbooks
    my $workbook1   = Spreadsheet::WriteExcel-&gt;new(&quot;workbook1.xls&quot;);
    my $workbook2   = Spreadsheet::WriteExcel-&gt;new(&quot;workbook2.xls&quot;);
    my $worksheet1  = $workbook-&gt;addworksheet();
    my $worksheet2  = $workbook-&gt;addworksheet();
    my $format1     = $workbook-&gt;addformat();
    my $format2     = $workbook-&gt;addformat();
</PRE>
</P>
<P>
<PRE>
    # Create a global format object that isn't tied to a workbook
    my $global      = Spreadsheet::WriteExcel::Format-&gt;new();
    $global-&gt;set_color('blue');
</PRE>
</P>
<P>
<PRE>
    # Copy the global format properties to the worksheet formats
    $format1-&gt;copy($global);
    $format2-&gt;copy($global);
</PRE>
</P>
<P>
Note: this is not a copy constructor, both objects must exist prior to
copying.

</P>
<P>
<HR>
<H2><A NAME="set_font_fontname_">set_font($fontname)</A></H2>
<P>
<PRE>
    Default state:      Font is Arial
    Default action:     None
    Valid args:         Any valid font name
</PRE>
</P>
<P>
Specify the font used:

</P>
<P>
<PRE>
    $format-&gt;set_font('Times New Roman');
</PRE>
</P>
<P>
Excel can only display fonts that are installed on the system that it is
running on. Therefore it is best to use the fonts that come as standard
such as 'Arial', 'Times New Roman' and 'Courier New'. See also the Fonts
worksheet created by formats.pl

</P>
<P>
<HR>
<H2><A NAME="set_size_">set_size()</A></H2>
<P>
<PRE>
    Default state:      Font size is 10
    Default action:     Set font size to 1
    Valid args:         Integer values from 1 to as big as your screen.
</PRE>
</P>
<P>
Set the font size. Excel adjusts the height of a row to accommodate the
largest font size in the row. You can also explicitly specify the height of
a row using the <CODE>set_row()</CODE> worksheet method.

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_size(30);
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_color_">set_color()</A></H2>
<P>
<PRE>
    Default state:      Excels default color, usually black
    Default action:     Set the default color
    Valid args:         Integers form 8..63 or the following strings:
                        'aqua'
                        'black'
                        'blue'
                        'fuchsia'
                        'gray'
                        'green'
                        'lime'
                        'navy'
                        'orange'
                        'purple'
                        'red'
                        'silver'
                        'white'
                        'yellow'
</PRE>
</P>
<P>
Set the font colour. The <CODE>set_color()</CODE> method is used as follows:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_color('red');
    $worksheet-&gt;write(0, 0, &quot;wheelbarrow&quot;, $format);
</PRE>
</P>
<P>
Note: The <CODE>set_color()</CODE> method is used to set the colour of the font in a cell. To set the colour
of a cell use the <CODE>set_fg_color()</CODE> and <CODE>set_pattern()</CODE> methods.

</P>
<P>
For additional examples see the 'Named colors' and 'Standard colors'
worksheets created by formats.pl

</P>
<P>
<HR>
<H2><A NAME="set_bold_">set_bold()</A></H2>
<P>
<PRE>
    Default state:      bold is off
    Default action:     Turn bold on
    Valid args:         0, 1 [1]
</PRE>
</P>
<P>
Set the bold property of the font:

</P>
<P>
<PRE>
    $format-&gt;set_bold();  # Turn bold on
</PRE>
</P>
<P>
[1] Actually, values in the range 100..1000 are also valid. 400 is normal,
700 is bold and 1000 is very bold indeed. It is probably best to set the
value to 1 and use normal bold.

</P>
<P>
<HR>
<H2><A NAME="set_italic_">set_italic()</A></H2>
<P>
<PRE>
    Default state:      Italic is off
    Default action:     Turn italic on
    Valid args:         0, 1
</PRE>
</P>
<P>
Set the italic property of the font.

</P>
<P>
<HR>
<H2><A NAME="set_underline_">set_underline()</A></H2>
<P>
<PRE>
    Default state:      Underline is off
    Default action:     Turn on single underline
    Valid args:         0  = No underline
                        1  = Single underline
                        2  = Double underline
                        33 = Single accounting underline
                        34 = Double accounting underline
</PRE>
</P>
<P>
Set the underline property of the font.

</P>
<P>
<HR>
<H2><A NAME="set_strikeout_">set_strikeout()</A></H2>
<P>
<PRE>
    Default state:      Strikeout is off
    Default action:     Turn strikeout on
    Valid args:         0, 1
</PRE>
</P>
<P>
Set the strikeout property of the font.

</P>
<P>
<HR>
<H2><A NAME="set_script_">set_script()</A></H2>
<P>
<PRE>
    Default state:      Super/Subscript is off
    Default action:     Turn Superscript on
    Valid args:         0  = Normal
                        1  = Superscript
                        2  = Subscript
</PRE>
</P>
<P>
Set the superscript/subscript property of the font. This format is
currently not very useful.

</P>
<P>
<HR>
<H2><A NAME="set_outline_">set_outline()</A></H2>
<P>
<PRE>
    Default state:      Outline is off
    Default action:     Turn outline on
    Valid args:         0, 1
</PRE>
</P>
<P>
Macintosh only.

</P>
<P>
<HR>
<H2><A NAME="set_shadow_">set_shadow()</A></H2>
<P>
<PRE>
    Default state:      Shadow is off
    Default action:     Turn shadow on
    Valid args:         0, 1
</PRE>
</P>
<P>
Macintosh only.

</P>
<P>
<HR>
<H2><A NAME="set_num_format_">set_num_format()</A></H2>
<P>
<PRE>
    Default state:      General format
    Default action:     Format index 1
    Valid args:         See the following table
</PRE>
</P>
<P>
This method is used to define the numerical format of a number in Excel. It
controls whether a number is displayed as an integer, a floating point
number, a date, a currency value or some other user defined format.

</P>
<P>
The numerical format of a cell can be specified by using a format string or
an index to one of Excel's built-in formats:

</P>
<P>
<PRE>
    my $format1 = $workbook-&gt;addformat();
    my $format2 = $workbook-&gt;addformat();
    $format1-&gt;set_num_format('d mmm yyyy'); # Format string
    $format2-&gt;set_num_format(0x0f);         # Format index
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(0, 0, 36892.521, $format1);      # 1 Jan 2001
    $worksheet-&gt;write(0, 0, 36892.521, $format2);      # 1-Jan-01
</PRE>
</P>
<P>
Using format strings you can define very sophisticated formatting of
numbers.

</P>
<P>
<PRE>
    $format01-&gt;set_num_format('0.000');
    $worksheet-&gt;write(0,  0, 3.1415926, $format01);    # 3.142
</PRE>
</P>
<P>
<PRE>
    $format02-&gt;set_num_format('#,##0');
    $worksheet-&gt;write(1,  0, 1234.56,   $format02);    # 1,235
</PRE>
</P>
<P>
<PRE>
    $format03-&gt;set_num_format('#,##0.00');
    $worksheet-&gt;write(2,  0, 1234.56,   $format03);    # 1,234.56
</PRE>
</P>
<P>
<PRE>
    $format04-&gt;set_num_format('$0.00');
    $worksheet-&gt;write(3,  0, 49.99,     $format04);    # $49.99
</PRE>
</P>
<P>
<PRE>
    $format05-&gt;set_num_format('0.00');
    $worksheet-&gt;write(4,  0, 49.99,     $format05);    # 49.99
</PRE>
</P>
<P>
<PRE>
    $format06-&gt;set_num_format('0.00');
    $worksheet-&gt;write(5,  0, 49.99,     $format06);    # 49.99
</PRE>
</P>
<P>
<PRE>
    $format07-&gt;set_num_format('mm/dd/yy');
    $worksheet-&gt;write(6,  0, 36892.521, $format07);    # 01/01/01
</PRE>
</P>
<P>
<PRE>
    $format08-&gt;set_num_format('mmm d yyyy');
    $worksheet-&gt;write(7,  0, 36892.521, $format08);    # Jan 1 2001
</PRE>
</P>
<P>
<PRE>
    $format09-&gt;set_num_format('d mmmm yyyy');
    $worksheet-&gt;write(8,  0, 36892.521, $format09);    # 1 January 2001
</PRE>
</P>
<P>
<PRE>
    $format10-&gt;set_num_format('dd/mm/yyyy hh:mm AM/PM');
    $worksheet-&gt;write(9,  0, 36892.521, $format10);    # 01/01/2001 12:30 AM
</PRE>
</P>
<P>
<PRE>
    $format11-&gt;set_num_format('0 &quot;dollar and&quot; .00 &quot;cents&quot;');
    $worksheet-&gt;write(10, 0, 1.87,      $format11);    # 1 dollar and .87 cents
</PRE>
</P>
<P>
<PRE>
    # Conditional formatting
    $format12-&gt;set_num_format('[Green]General;[Red]-General;General');
    $worksheet-&gt;write(11, 0, 123,       $format12);    # &gt; 0 Green
    $worksheet-&gt;write(12, 0, -45,       $format12);    # &lt; 0 Red
    $worksheet-&gt;write(13, 0, 0,         $format12);    # = 0 Default colour
</PRE>
</P>
<P>
The colour format should have one of the following values:

</P>
<P>
<PRE>
    [Black] [Blue] [Cyan] [Green] [Magenta] [Red] [White] [Yellow]
</PRE>
</P>
<P>
Alternatively you can specify the colour based on a colour index as
follows: <CODE>[Color n]</CODE>, where n is a standard Excel colour index - 7. See the 'Standard colors'
worksheet created by formats.pl.

</P>
<P>
For more information refer to the documentation on formatting in the <CODE>doc</CODE> directory of the Spreadsheet::WriteExcel distro, the Excel on-line help or
to the tutorial at: <A
HREF="http://support.microsoft.com/support/Excel/Content/Formats/default.asp">http://support.microsoft.com/support/Excel/Content/Formats/default.asp</A>
and <A
HREF="http://support.microsoft.com/support/Excel/Content/Formats/codes.asp">http://support.microsoft.com/support/Excel/Content/Formats/codes.asp</A>


</P>
<P>
You should ensure that the format string is valid in Excel prior to using
it in WriteExcel.

</P>
<P>
One of the most common uses of the <CODE>set_num_format()</CODE> is to format a number as a date. Excel stores dates as a real number where
the integer part of the number stores the number of days since the epoch
and the fractional part stores the percentage of the day. The epoch can be
either 1900 or 1904. Excel for Windows uses 1900 and Excel for Macintosh
uses 1904. However, Excel on either platform will convert automatically
between one system and the other. For an example of how to convert between
UNIX/Perl time and Excel time have a look at the <CODE>ms_time.pl</CODE> program in the <CODE>examples</CODE> directory of the WriteExcel distribution.

</P>
<P>
Excel's built-in formats are shown in the following table:

</P>
<P>
<PRE>
    Index   Index   Format String
    0       0x00    General
    1       0x01    0
    2       0x02    0.00
    3       0x03    #,##0
    4       0x04    #,##0.00
    5       0x05    ($#,##0_);($#,##0)
    6       0x06    ($#,##0_);[Red]($#,##0)
    7       0x07    ($#,##0.00_);($#,##0.00)
    8       0x08    ($#,##0.00_);[Red]($#,##0.00)
    9       0x09    0%
    10      0x0a    0.00%
    11      0x0b    0.00E+00
    12      0x0c    # ?/?
    13      0x0d    # ??/??
    14      0x0e    m/d/yy
    15      0x0f    d-mmm-yy
    16      0x10    d-mmm
    17      0x11    mmm-yy
    18      0x12    h:mm AM/PM
    19      0x13    h:mm:ss AM/PM
    20      0x14    h:mm
    21      0x15    h:mm:ss
    22      0x16    m/d/yy h:mm
    ..      ....    ...........
    37      0x25    (#,##0_);(#,##0)
    38      0x26    (#,##0_);[Red](#,##0)
    39      0x27    (#,##0.00_);(#,##0.00)
    40      0x28    (#,##0.00_);[Red](#,##0.00)
    41      0x29    _(* #,##0_);_(* (#,##0);_(* &quot;-&quot;_);_(@_)
    42      0x2a    _($* #,##0_);_($* (#,##0);_($* &quot;-&quot;_);_(@_)
    43      0x2b    _(* #,##0.00_);_(* (#,##0.00);_(* &quot;-&quot;??_);_(@_)
    44      0x2c    _($* #,##0.00_);_($* (#,##0.00);_($* &quot;-&quot;??_);_(@_)
    45      0x2d    mm:ss
    46      0x2e    [h]:mm:ss
    47      0x2f    mm:ss.0
    48      0x30    ##0.0E+0
    49      0x31    @
</PRE>
</P>
<P>
For examples of these formatting codes see the 'Numerical formats'
worksheet created by formats.pl.

</P>
<P>
Note 1. Numeric formats 23 to 36 are not documented by Microsoft and may
differ in international versions.

</P>
<P>
Note 2. In Excel 5 the dollar sign appears as a dollar sign. In Excel
97-2000 it appears as the defined local currency symbol.

</P>
<P>
Note 3. The red negative numeric formats display slightly differently in
Excel 5 and Excel 97-2000.

</P>
<P>
<HR>
<H2><A NAME="set_align_">set_align()</A></H2>
<P>
<PRE>
    Default state:      Alignment is off
    Default action:     Left alignment
    Valid args:         'left'              Horizontal
                        'center'
                        'right'
                        'fill'
                        'justify'
                        'merge'
</PRE>
</P>
<P>
<PRE>
                        'top'               Vertical
                        'vcenter'
                        'bottom'
                        'vjustify'
</PRE>
</P>
<P>
This method is used to set the horizontal and vertical text alignment
within a cell. Vertical and horizontal alignments can be combined. The
method is used as follows:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_align('center');
    $format-&gt;set_align('vcenter');
    $worksheet-&gt;set_row(0, 30);
    $worksheet-&gt;write(0, 0, &quot;X&quot;, $format);
</PRE>
</P>
<P>
Text can be aligned across two or more adjacent cells using the <CODE>merge</CODE> property. See also, the <CODE>set_merge()</CODE> method.

</P>
<P>
The <CODE>vjustify</CODE> (vertical justify) option can be used to provide automatic text wrapping in
a cell. The height of the cell will be adjusted to accommodate the wrapped
text. To specify where the text wraps use the <CODE>set_text_wrap()</CODE> method.

</P>
<P>
For further examples see the 'Alignment' worksheet created by formats.pl.

</P>
<P>
<HR>
<H2><A NAME="set_merge_">set_merge()</A></H2>
<P>
<PRE>
    Default state:      Cell merging is off
    Default action:     Turn cell merging on
    Valid args:         1
</PRE>
</P>
<P>
Text can be aligned across two or more adjacent cells using the <CODE>set_merge()</CODE> method. This is an alias for the unintuitive <CODE>set_align('merge')</CODE> method call.

</P>
<P>
Only one cell should contain the text, the other cells should be blank:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_merge();
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(1, 1, 'Merged cells', $format);
    $worksheet-&gt;write_blank(1, 2, $format);
</PRE>
</P>
<P>
See also the <CODE>merge1.pl</CODE> and <CODE>merge2.pl</CODE> programs in the <CODE>examples</CODE> directory.

</P>
<P>
<HR>
<H2><A NAME="set_text_wrap_">set_text_wrap()</A></H2>
<P>
<PRE>
    Default state:      Text wrap is off
    Default action:     Turn text wrap on
    Valid args:         0, 1
</PRE>
</P>
<P>
Here is an example using the text wrap property, the escape character <CODE>\n</CODE> is used to indicate the end of line:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_text_wrap();
    $worksheet-&gt;write(0, 0, &quot;It's\na bum\nwrap&quot;, $format);
</PRE>
</P>
<P>
Excel will adjust the height of the row to accommodate the wrapped text. A
similar effect can be obtained without newlines using the <CODE>set_align('vjustify')</CODE> method. See the <CODE>textwrap.pl</CODE> program in the <CODE>examples</CODE> directory.

</P>
<P>
<HR>
<H2><A NAME="set_rotation_">set_rotation()</A></H2>
<P>
<PRE>
    Default state:      Text rotation is off
    Default action:     Rotation style 1
    Valid args:         0 No rotation
                        1 Letters run from top to bottom
                        2 90 anticlockwise
                        3 90 clockwise
</PRE>
</P>
<P>
Set the rotation of the text in a cell. See the 'Alignment' worksheet
created by formats.pl.

</P>
<P>
<HR>
<H2><A NAME="set_text_justlast_">set_text_justlast()</A></H2>
<P>
<PRE>
    Default state:      Justify last is off
    Default action:     Turn justify last on
    Valid args:         0, 1
</PRE>
</P>
<P>
Only applies to Far Eastern versions of Excel.

</P>
<P>
<HR>
<H2><A NAME="set_pattern_">set_pattern()</A></H2>
<P>
<PRE>
    Default state:      Pattern is off
    Default action:     Solid fill is on
    Valid args:         0 .. 31
</PRE>
</P>
<P>
Examples of the available patterns are shown in the 'Patterns' worksheet
created by formats.pl. However, it is unlikely that you will ever need
anything other than Pattern 1 which is a solid fill of the foreground
color.

</P>
<P>
<HR>
<H2><A NAME="set_fg_color_">set_fg_color()</A></H2>
<P>
<PRE>
    Also applies to:    set_bg_color
</PRE>
</P>
<P>
<PRE>
    Default state:      Color is off
    Default action:     Undefined
    Valid args:         See set_color()
</PRE>
</P>
<P>
Note, the foreground and background colours will only have an effect if the
cell pattern has been set. In the most common case you can specify the
solid fill pattern and the foreground colour as follows:

</P>
<P>
<PRE>
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_pattern();         # Set pattern to 1, i.e. solid fill
    $format-&gt;set_fg_color('green'); # Note foreground and not background
    $worksheet-&gt;write(0, 0, &quot;Ray&quot;, $format);
</PRE>
</P>
<P>
<HR>
<H2><A NAME="set_border_">set_border()</A></H2>
<P>
<PRE>
    Also applies to:    set_bottom()
                        set_top()
                        set_left()
                        set_right()
</PRE>
</P>
<P>
<PRE>
    Default state:      Border is off
    Default action:     Set border type 1
    Valid args:         0 No border
                        1 Thin single border
                        2 Medium single border
                        3 Dashed border
                        4 Dotted border
                        5 Thick single border
                        6 Double line border
                        7 Hair border
</PRE>
</P>
<P>
A cell border is comprised of a border on the bottom, top, left and right.
These can be set to the same value using <CODE>set_border()</CODE> or individually using the relevant method calls shown above. Examples of
the available border styles are shown in the 'Borders' worksheet created by
formats.pl.

</P>
<P>
<HR>
<H2><A NAME="set_border_color_">set_border_color()</A></H2>
<P>
<PRE>
    Also applies to:    set_bottom_color()
                        set_top_color()
                        set_left_color()
                        set_right_color()
</PRE>
</P>
<P>
<PRE>
    Default state:      Color is off
    Default action:     Undefined
    Valid args:         See set_color()
</PRE>
</P>
<P>
Set the colour of the cell borders.

</P>
<P>
<HR>
<H1><A NAME="FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL</A></H1>
<P>
The first thing to note is that there are still some outstanding issues
with the implementation of formulas and functions:

</P>
<P>
<PRE>
    * Writing a formula is much slower than writing the equivalent string.
    * Unary minus isn't supported.
    * You cannot use arrays constants, i.e. {1;2;3}, in functions.
    * You cannot use embedded double quotes in strings.
    * Whitespace is not preserved around operators.
</PRE>
</P>
<P>
However, these constraints will be removed in future versions. They are
here because of a trade-off between features and time.

</P>
<P>
The following is a brief introduction to formulas and functions in Excel
and Spreadsheet::WriteExcel.

</P>
<P>
A formula is a string that begins with an equal sign:

</P>
<P>
<PRE>
    '=A1+B1'
    '=AVERAGE(1, 2, 3)'
</PRE>
</P>
<P>
The formula can contain numbers, strings, boolean values, cell references,
cell ranges and functions. Formulas should be written as they appear in
Excel, that is cells and functions must be in uppercase.

</P>
<P>
Cells in Excel are referenced using the A1 notation system where the column
is designated by a letter and the row by a number. Columns range from A to
IV i.e. 0 to 255, rows range from 1 to 16384. In the <CODE>examples</CODE> directory of the distro there is program called <CODE>convertA1.pl</CODE> which contains functions to help you work with this system.

</P>
<P>
The Excel <CODE>$</CODE> notation in cell references is also supported. This allows you to specify
whether a row or column is relative or absolute. This only has an effect if
the cell is copied. The following examples show relative and absolute
values.

</P>
<P>
<PRE>
    '=A1'   # Column and row are relative
    '=$A1'  # Column is absolute and row is relative
    '=A$1'  # Column is relative and row is absolute
    '=$A$1' # Column and row are absolute
</PRE>
</P>
<P>
Formulas can also refer to cells in other worksheets of the current
workbook. For example:

</P>
<P>
<PRE>
    '=Sheet2!A1'
    '=Sheet2!A1:A5'
    '=Sheet2:Sheet3!A1'
    '=Sheet2:Sheet3!A1:A5'
    q{='Test Data'!A1}
    q{='Test Data1:Test Data2'!A1}
</PRE>
</P>
<P>
The sheet reference and and the cell reference are separated by  <CODE>!</CODE> the exclamation mark symbol. If worksheet names contain spaces then Excel
requires them to be enclosed in single quotes as in the last two examples
above. In this case you will have to use the quote operator <CODE>q{}</CODE> to protect the quotes. See <CODE>perlop</CODE> in the main Perl documentation. Only valid sheet names that have been added
using the <CODE>addworksheet()</CODE> method can be used in formulas. You cannot reference external workbooks.

</P>
<P>
The following table lists the operators that are available in Excel's
formulas. The majority of the operators are the same as Perl's. Differences
are indicated.

</P>
<P>
<PRE>
    Arithmetic operators:
    =====================
    Operator  Meaning                   Example
       +      Addition                  1+2
       -      Subtraction               2-1
       *      Multiplication            2*3
       /      Division                  1/4
       ^      Exponentiation            2^3      # Equivalent to **
       -      Unary minus               -(1+2)   # Not yet supported
       %      Percent (Not modulus)     13%      # Not supported, [1]
</PRE>
</P>
<P>
<PRE>
    Comparison operators:
    =====================
    Operator  Meaning                   Example
        =     Equal to                  A1 =  B1 # Equivalent to ==
        &lt;&gt;    Not equal to              A1 &lt;&gt; B1 # Equivalent to !=
        &gt;     Greater than              A1 &gt;  B1
        &lt;     Less than                 A1 &lt;  B1
        &gt;=    Greater than or equal to  A1 &gt;= B1
        &lt;=    Less than or equal to     A1 &lt;= B1
</PRE>
</P>
<P>
<PRE>
    String operator:
    ================
    Operator  Meaning                   Example
        &amp;     Concatenation             &quot;Hello &quot; &amp; &quot;World!&quot; # [2]
</PRE>
</P>
<P>
<PRE>
    Reference operators:
    ====================
    Operator  Meaning                   Example
        :     Range operator            A1:A4               # [3]
        ,     Union operator            SUM(1, 2+2, B3)     # [4]
</PRE>
</P>
<P>
<PRE>
    Notes:
    [1]: You can get a percentage with formatting and modulus with MOD().
    [2]: Equivalent to (&quot;Hello &quot; . &quot;World!&quot;) in Perl.
    [3]: This range is equivalent to cells A1, A2, A3 and A4.
    [4]: The comma behaves like the list separator in Perl.
</PRE>
</P>
<P>
The range and comma operators can have different symbols in non-English
versions of Excel. These will be supported in a later version of
Spreadsheet::WriteExcel.

</P>
<P>
The following table lists all of the core functions supported by Excel 5
and Spreadsheet::WriteExcel. Any additional functions that are available
through the &quot;Analysis ToolPak&quot; or other add-ins are not
supported. These functions have all been tested to verify that they work.

</P>
<P>
<PRE>
    ABS           DB            INDIRECT      NORMINV       SLN
    ACOS          DCOUNT        INFO          NORMSDIST     SLOPE
    ACOSH         DCOUNTA       INT           NORMSINV      SMALL
    ADDRESS       DDB           INTERCEPT     NOT           SQRT
    AND           DEGREES       IPMT          NOW           STANDARDIZE
    AREAS         DEVSQ         IRR           NPER          STDEV
    ASIN          DGET          ISBLANK       NPV           STDEVP
    ASINH         DMAX          ISERR         ODD           STEYX
    ATAN          DMIN          ISERROR       OFFSET        SUBSTITUTE
    ATAN2         DOLLAR        ISLOGICAL     OR            SUBTOTAL
    ATANH         DPRODUCT      ISNA          PEARSON       SUM
    AVEDEV        DSTDEV        ISNONTEXT     PERCENTILE    SUMIF
    AVERAGE       DSTDEVP       ISNUMBER      PERCENTRANK   SUMPRODUCT
    BETADIST      DSUM          ISREF         PERMUT        SUMSQ
    BETAINV       DVAR          ISTEXT        PI            SUMX2MY2
    BINOMDIST     DVARP         KURT          PMT           SUMX2PY2
    CALL          ERROR.TYPE    LARGE         POISSON       SUMXMY2
    CEILING       EVEN          LEFT          POWER         SYD
    CELL          EXACT         LEN           PPMT          T
    CHAR          EXP           LINEST        PROB          TAN
    CHIDIST       EXPONDIST     LN            PRODUCT       TANH
    CHIINV        FACT          LOG           PROPER        TDIST
    CHITEST       FALSE         LOG10         PV            TEXT
    CHOOSE        FDIST         LOGEST        QUARTILE      TIME
    CLEAN         FIND          LOGINV        RADIANS       TIMEVALUE
    CODE          FINV          LOGNORMDIST   RAND          TINV
    COLUMN        FISHER        LOOKUP        RANK          TODAY
    COLUMNS       FISHERINV     LOWER         RATE          TRANSPOSE
    COMBIN        FIXED         MATCH         REGISTER.ID   TREND
    CONCATENATE   FLOOR         MAX           REPLACE       TRIM
    CONFIDENCE    FORECAST      MDETERM       REPT          TRIMMEAN
    CORREL        FREQUENCY     MEDIAN        RIGHT         TRUE
    COS           FTEST         MID           ROMAN         TRUNC
    COSH          FV            MIN           ROUND         TTEST
    COUNT         GAMMADIST     MINUTE        ROUNDDOWN     TYPE
    COUNTA        GAMMAINV      MINVERSE      ROUNDUP       UPPER
    COUNTBLANK    GAMMALN       MIRR          ROW           VALUE
    COUNTIF       GEOMEAN       MMULT         ROWS          VAR
    COVAR         GROWTH        MOD           RSQ           VARP
    CRITBINOM     HARMEAN       MODE          SEARCH        VDB
    DATE          HLOOKUP       MONTH         SECOND        VLOOKUP
    DATEVALUE     HOUR          N             SIGN          WEEKDAY
    DAVERAGE      HYPGEOMDIST   NA            SIN           WEIBULL
    DAY           IF            NEGBINOMDIST  SINH          YEAR
    DAYS360       INDEX         NORMDIST      SKEW          ZTEST
</PRE>
</P>
<P>
You can also modify the module to support function names in the following
languages: German, French, Spanish, Portuguese, Dutch, Finnish, Italian and
Swedish. See the <CODE>function_locale.pl</CODE> program in the <CODE>examples</CODE> directory of the distro.

</P>
<P>
For a general introduction to Excel's formulas and an explanation of the
syntax of the function refer to the Excel help files or the following
links: <A
HREF="http://msdn.microsoft.com/library/default.asp?URL=/library/officedev/office97/s88f2.htm">http://msdn.microsoft.com/library/default.asp?URL=/library/officedev/office97/s88f2.htm</A>
and <A
HREF="http://msdn.microsoft.com/library/default.asp?URL=/library/officedev/office97/s992f.htm">http://msdn.microsoft.com/library/default.asp?URL=/library/officedev/office97/s992f.htm</A>


</P>
<P>
If your formula doesn't work in Spreadsheet::WriteExcel try the following:

</P>
<P>
<PRE>
    1. Verify that the formula works in Excel (or Gnumeric or OpenOffice).
    2. Ensure that it isn't on the TODO list at the start of this section.
    3. Ensure that cell references and formula names are in uppercase.
    4. Ensure that you are using the U.S. style range and union operators.
    5. Ensure the function is in the above table.
</PRE>
</P>
<P>
If you go through steps 1-5 and you still have a problem, mail me.

</P>
<P>
<HR>
<H1><A NAME="EXAMPLES">EXAMPLES</A></H1>
<P>
There are additional examples in the <CODE>examples</CODE> directory of the Spreadsheet::WriteExcel distro.

</P>
<P>
<HR>
<H2><A NAME="Example_1">Example 1</A></H2>
<P>
The following example shows some of the basic features of
Spreadsheet::WriteExcel.

</P>
<P>
<PRE>
    #!/usr/bin/perl -w
</PRE>
</P>
<P>
<PRE>
    use strict;
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    # Create a new workbook called simple.xls and add a worksheet
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(&quot;simple.xls&quot;);
    my $worksheet = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<PRE>
    # The general syntax is write($row, $column, $token). Note that row and
    # column are zero indexed
</PRE>
</P>
<P>
<PRE>
    # Write some text
    $worksheet-&gt;write(0, 0,  &quot;Hi Excel!&quot;);
</PRE>
</P>
<P>
<PRE>
    # Write some numbers
    $worksheet-&gt;write(2, 0,  3);          # Writes 3
    $worksheet-&gt;write(3, 0,  3.00000);    # Writes 3
    $worksheet-&gt;write(4, 0,  3.00001);    # Writes 3.00001
    $worksheet-&gt;write(5, 0,  3.14159);    # TeX revision no.?
</PRE>
</P>
<P>
<PRE>
    # Write some formulas
    $worksheet-&gt;write(7, 0,  '=A3 + A6');
    $worksheet-&gt;write(8, 0,  '=IF(A5&gt;3,&quot;Yes&quot;, &quot;No&quot;)');
</PRE>
</P>
<P>
<PRE>
    # Write a hyperlink
    $worksheet-&gt;write(10, 0, 'http://www.perl.com/');
</PRE>
</P>

<br><center><img SRC="simple.gif" ALT="The output from simple.pl"></center>

<P>
<HR>
<H2><A NAME="Example_2">Example 2</A></H2>
<P>
The following is a general example which demonstrates some features of
working with multiple worksheets.

</P>
<P>
<PRE>
    #!/usr/bin/perl -w
</PRE>
</P>
<P>
<PRE>
    use strict;
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    # Create a new Excel workbook
    my $workbook = Spreadsheet::WriteExcel-&gt;new(&quot;regions.xls&quot;);
</PRE>
</P>
<P>
<PRE>
    # Add some worksheets
    my $north = $workbook-&gt;addworksheet(&quot;North&quot;);
    my $south = $workbook-&gt;addworksheet(&quot;South&quot;);
    my $east  = $workbook-&gt;addworksheet(&quot;East&quot;);
    my $west  = $workbook-&gt;addworksheet(&quot;West&quot;);
</PRE>
</P>
<P>
<PRE>
    # Add a Format
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_bold();
    $format-&gt;set_color('blue');
</PRE>
</P>
<P>
<PRE>
    # Add a caption to each worksheet
    foreach my $worksheet (@{$workbook-&gt;worksheets()}) {
        $worksheet-&gt;write(0, 0, &quot;Sales&quot;, $format);
    }
</PRE>
</P>
<P>
<PRE>
    # Write some data
    $north-&gt;write(0, 1, 200000);
    $south-&gt;write(0, 1, 100000);
    $east-&gt;write (0, 1, 150000);
    $west-&gt;write (0, 1, 100000);
</PRE>
</P>
<P>
<PRE>
    # Set the active worksheet
    $south-&gt;activate();
</PRE>
</P>
<P>
<PRE>
    # Set the width of the first column
    $south-&gt;set_column(0, 0, 20);
</PRE>
</P>
<P>
<PRE>
    # Set the active cell
    $south-&gt;set_selection(0, 1);
</PRE>
</P>

<br><center><img SRC="regions.gif" ALT="The output from regions.pl"></center>

<P>
<HR>
<H2><A NAME="Example_3">Example 3</A></H2>
<P>
This example shows how to use a conditional numerical format with colours
to indicate if a share price has gone up or down.

</P>
<P>
<PRE>
    use strict;
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    # Create a new workbook and add a worksheet
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(&quot;stocks.xls&quot;);
    my $worksheet = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<PRE>
    # Set the column width for columns 1, 2, 3 and 4
    $worksheet-&gt;set_column(0, 3, 15);
</PRE>
</P>
<P>
<PRE>
    # Create a format for the column headings
    my $header = $workbook-&gt;addformat();
    $header-&gt;set_bold();
    $header-&gt;set_size(12);
    $header-&gt;set_color('blue');
</PRE>
</P>
<P>
<PRE>
    # Create a format for the stock price
    my $f_price = $workbook-&gt;addformat();
    $f_price-&gt;set_align('left');
    $f_price-&gt;set_num_format('$0.00');
</PRE>
</P>
<P>
<PRE>
    # Create a format for the stock volume
    my $f_volume = $workbook-&gt;addformat();
    $f_volume-&gt;set_align('left');
    $f_volume-&gt;set_num_format('#,##0');
</PRE>
</P>
<P>
<PRE>
    # Create a format for the price change. This is an example of a conditional
    # format. The number is formatted as a percentage. If it is positive it is
    # formatted in green, if it is negative it is formatted in red and if it is
    # zero it is formatted as the default font colour (in this case black).
    # Note: the [Green] format produces an unappealing lime green. Try
    # [Color 10] instead for a dark green.
    #
    my $f_change = $workbook-&gt;addformat();
    $f_change-&gt;set_align('left');
    $f_change-&gt;set_num_format('[Green]0.0%;[Red]-0.0%;0.0%');
</PRE>
</P>
<P>
<PRE>
    # Write out the data
    $worksheet-&gt;write(0, 0, 'Company',$header);
    $worksheet-&gt;write(0, 1, 'Price',  $header);
    $worksheet-&gt;write(0, 2, 'Volume', $header);
    $worksheet-&gt;write(0, 3, 'Change', $header);
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(1, 0, 'Damage Inc.'       );
    $worksheet-&gt;write(1, 1, 30.25,    $f_price ); # $30.25
    $worksheet-&gt;write(1, 2, 1234567,  $f_volume); # 1,234,567
    $worksheet-&gt;write(1, 3, 0.085,    $f_change); # 8.5% in green
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(2, 0, 'Dump Corp.'        );
    $worksheet-&gt;write(2, 1, 1.56,     $f_price ); # $1.56
    $worksheet-&gt;write(2, 2, 7564,     $f_volume); # 7,564
    $worksheet-&gt;write(2, 3, -0.015,   $f_change); # -1.5% in red
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(3, 0, 'Rev Ltd.'          );
    $worksheet-&gt;write(3, 1, 0.13,     $f_price ); # $0.13
    $worksheet-&gt;write(3, 2, 321,      $f_volume); # 321
    $worksheet-&gt;write(3, 3, 0,        $f_change); # 0 in the font color (black)
</PRE>
</P>

<br><center><img SRC="stocks.gif" ALT="The output from stocks.pl"></center>

<P>
<HR>
<H2><A NAME="Example_4">Example 4</A></H2>
<P>
The following is a simple example of using functions.

</P>
<P>
<PRE>
    #!/usr/bin/perl -w
</PRE>
</P>
<P>
<PRE>
    use strict;
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    # Create a new workbook and add a worksheet
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(&quot;stats.xls&quot;);
    my $worksheet = $workbook-&gt;addworksheet('Test data');
</PRE>
</P>
<P>
<PRE>
    # Set the column width for columns 1
    $worksheet-&gt;set_column(0, 0, 20);
</PRE>
</P>
<P>
<PRE>
    # Create a format for the headings
    my $format = $workbook-&gt;addformat();
    $format-&gt;set_bold();
</PRE>
</P>
<P>
<PRE>
    # Write the sample data
    $worksheet-&gt;write(0, 0, 'Sample', $format);
    $worksheet-&gt;write(0, 1, 1);
    $worksheet-&gt;write(0, 2, 2);
    $worksheet-&gt;write(0, 3, 3);
    $worksheet-&gt;write(0, 4, 4);
    $worksheet-&gt;write(0, 5, 5);
    $worksheet-&gt;write(0, 6, 6);
    $worksheet-&gt;write(0, 7, 7);
    $worksheet-&gt;write(0, 8, 8);
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(1, 0, 'Length', $format);
    $worksheet-&gt;write(1, 1, 25.4);
    $worksheet-&gt;write(1, 2, 25.4);
    $worksheet-&gt;write(1, 3, 24.8);
    $worksheet-&gt;write(1, 4, 25.0);
    $worksheet-&gt;write(1, 5, 25.3);
    $worksheet-&gt;write(1, 6, 24.9);
    $worksheet-&gt;write(1, 7, 25.2);
    $worksheet-&gt;write(1, 8, 24.8);
</PRE>
</P>
<P>
<PRE>
    # Write some statistical functions
    $worksheet-&gt;write(4,  0, 'Count', $format);
    $worksheet-&gt;write(4,  1, '=COUNT(B1:I1)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(5,  0, 'Sum', $format);
    $worksheet-&gt;write(5,  1, '=SUM(B2:I2)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(6,  0, 'Average', $format);
    $worksheet-&gt;write(6,  1, '=AVERAGE(B2:I2)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(7,  0, 'Min', $format);
    $worksheet-&gt;write(7,  1, '=MIN(B2:I2)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(8,  0, 'Max', $format);
    $worksheet-&gt;write(8,  1, '=MAX(B2:I2)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(9,  0, 'Standard Deviation', $format);
    $worksheet-&gt;write(9,  1, '=STDEV(B2:I2)');
</PRE>
</P>
<P>
<PRE>
    $worksheet-&gt;write(10, 0, 'Kurtosis', $format);
    $worksheet-&gt;write(10, 1, '=KURT(B2:I2)');
</PRE>
</P>

<br><center><img SRC="stats.gif" ALT="The output from stats.pl"></center>

<P>
<HR>
<H2><A NAME="Example_5">Example 5</A></H2>
<P>
The following example converts a tab separated file called <CODE>tab.txt</CODE> into an Excel file called <CODE>tab.xls</CODE>.

</P>
<P>
<PRE>
    #!/usr/bin/perl -w
</PRE>
</P>
<P>
<PRE>
    use strict;
    use Spreadsheet::WriteExcel;
</PRE>
</P>
<P>
<PRE>
    open (TABFILE, &quot;tab.txt&quot;) or die &quot;tab.txt: $!&quot;;
</PRE>
</P>
<P>
<PRE>
    my $workbook  = Spreadsheet::WriteExcel-&gt;new(&quot;tab.xls&quot;);
    my $worksheet = $workbook-&gt;addworksheet();
</PRE>
</P>
<P>
<PRE>
    # Row and column are zero indexed
    my $row = 0;
</PRE>
</P>
<P>
<PRE>
    while (&lt;TABFILE&gt;) {
        chomp;
        # Split on single tab
        my @Fld = split('\t', $_);
</PRE>
</P>
<P>
<PRE>
        my $col = 0;
        foreach my $token (@Fld) {
            $worksheet-&gt;write($row, $col, $token);
            $col++;
        }
        $row++;
    }
</PRE>
</P>
<P>
<HR>
<H1><A NAME="LIMITATIONS">LIMITATIONS</A></H1>
<P>
The following limits are imposed by Excel or the version of the BIFF file
that has been implemented:

</P>
<P>
<PRE>
    Description                          Limit   Source
    -----------------------------------  ------  -------
    Maximum number of chars in a string  255     Excel 5
    Maximum number of columns            256     Excel 5, 97
    Maximum number of rows in Excel 5    16384   Excel 5
    Maximum number of rows in Excel 97   65536   Excel 97
</PRE>
</P>
<P>
Note: the maximum row reference in a formula is the Excel 5 row limit of
16384.

</P>
<P>
The minimum file size is 6K due to the OLE overhead. The maximum file size
is approximately 7MB (7087104 bytes) of BIFF data. This can be extended by
using Takanori Kawai's OLE::Storage_Lite module <A
HREF="http://search.cpan.org/search?dist=OLE-Storage_Lite">http://search.cpan.org/search?dist=OLE-Storage_Lite</A>
see the <CODE>bigfile.pl</CODE> example in the <CODE>examples</CODE> directory of the distro.

</P>
<P>
<HR>
<H1><A NAME="REQUIREMENTS">REQUIREMENTS</A></H1>
<P>
This module requires Perl 5.005 (or later) and Parse::RecDescent: <A
HREF="http://search.cpan.org/search?dist=Parse-RecDescent">http://search.cpan.org/search?dist=Parse-RecDescent</A>


</P>
<P>
<HR>
<H1><A NAME="PORTABILITY">PORTABILITY</A></H1>
<P>
Spreadsheet::WriteExcel.pm will work on the majority of Windows, UNIX and
Macintosh platforms. Specifically, the module will work on any system where
perl packs floats in the 64 bit IEEE format. The float must also be in
little-endian format but WriteExcel.pm will reverse it as necessary. Thus:

</P>
<P>
<PRE>
    print join(&quot; &quot;, map { sprintf &quot;%#02x&quot;, $_ } unpack(&quot;C*&quot;, pack &quot;d&quot;, 1.2345)), &quot;\n&quot;;
</PRE>
</P>
<P>
should give (or in reverse order):

</P>
<P>
<PRE>
    0x8d 0x97 0x6e 0x12 0x83 0xc0 0xf3 0x3f
</PRE>
</P>
<P>
In general, if you don't know whether your system supports a 64 bit IEEE
float or not, it probably does. If your system doesn't, WriteExcel will <CODE>croak()</CODE> with the message given in the <A HREF="#DIAGNOSTICS">DIAGNOSTICS</A> section. You can check which platforms the module has been tested on at the
CPAN testers site: <A
HREF="http://testers.cpan.org/search?request=dist&dist=Spreadsheet-WriteExcel">http://testers.cpan.org/search?request=dist&dist=Spreadsheet-WriteExcel</A>


</P>
<P>
<HR>
<H1><A NAME="DIAGNOSTICS">DIAGNOSTICS</A></H1>
<DL>
<DT><A NAME="item_Filename">Filename required in WriteExcel('Filename')</A><DD>
<P>
A filename must be given in the constructor.

</P>
<DT><A NAME="item_Can">Can't open filename. It may be in use.</A><DD>
<P>
The file cannot be opened for writing. The directory that you are writing
to may be protected or the file may be in use by another program.

</P>
<DT><A NAME="item_Required">Required floating point format not supported on this platform.</A><DD>
<P>
Operating system doesn't support 64 bit IEEE float or it is byte-ordered in
a way unknown to WriteExcel.

</P>
<DT><A NAME="item_Unable">Unable to create tmp files via IO::File-&gt;new_tmpfile().</A><DD>
<P>
This is a <CODE>-w</CODE> warning. You will see it if you are using Spreadsheet::WriteExcel in an
environment where temporary files cannot be created, in which case all data
will be stored in memory. The warning is for information only: it does not
affect execution but it may affect the speed of execution for large files.

</P>
<DT><A NAME="item_Maximum">Maximum file size, 7087104, exceeded.</A><DD>
<P>
The current OLE implementation only supports a maximum BIFF file of this
size. This limit can be extended, see the <A HREF="#LIMITATIONS">LIMITATIONS</A> section.

</P>
<DT>Can't locate Parse/RecDescent.pm in @INC ...<DD>
<P>
Spreadsheet::WriteExcel requires the Parse::RecDescent module. Download it
from CPAN: <A
HREF="http://search.cpan.org/search?dist=Parse-RecDescent">http://search.cpan.org/search?dist=Parse-RecDescent</A>


</P>
<DT><A NAME="item_Couldn">Couldn't parse formula ...</A><DD>
<P>
There are a large number of warnings which relate to badly formed formulas
and functions. See the <A HREF="#FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL</A> section for suggestions on how to avoid these errors.

</P>
</DL>
<P>
<HR>
<H1><A NAME="THE_EXCEL_BINARY_FORMAT">THE EXCEL BINARY FORMAT</A></H1>
<P>
Excel data is stored in the &quot;Binary Interchange File Format&quot;
(BIFF) file format. Details of this format are given in the Excel SDK, the
&quot;Excel Developer's Kit&quot; from Microsoft Press. It is also included
in the MSDN CD library but is no longer available on the MSDN website. An
older version of the BIFF documentation is available at <A
HREF="http://www.cubic.org/source/archive/fileform/misc/excel.txt">http://www.cubic.org/source/archive/fileform/misc/excel.txt</A>


</P>
<P>
Issues relating to the Excel SDK are discussed, occasionally, at <A
HREF="news://microsoft.public.excel.sdk">news://microsoft.public.excel.sdk</A>


</P>
<P>
The BIFF portion of the Excel file is comprised of contiguous binary
records that have different functions and that hold different types of
data. Each BIFF record is comprised of the following three parts:

</P>
<P>
<PRE>
        Record name;   Hex identifier, length = 2 bytes
        Record length; Length of following data, length = 2 bytes
        Record data;   Data, length = variable
</PRE>
</P>
<P>
The BIFF data is stored along with other data in an OLE Compound File. This
is a structured storage which acts like a file system within a file. A
Compound File is comprised of storages and streams which, to follow the
file system analogy, are like directories and files.

</P>
<P>
The documentation for the OLE::Storage module, <A
HREF="http://user.cs.tu-berlin.de/~schwartz/pmh/guide.html">http://user.cs.tu-berlin.de/~schwartz/pmh/guide.html</A>
, contains one of the few descriptions of the OLE Compound File in the
public domain.

</P>
<P>
For a open source implementation of the OLE library see the 'cole' library
at <A HREF="http://atena.com/libole2.php">http://atena.com/libole2.php</A>

</P>
<P>
The source code for the Excel plugin of the Gnumeric spreadsheet also
contains information relevant to the Excel BIFF format and the OLE
container, <A
HREF="http://www.gnumeric.org/gnumeric">http://www.gnumeric.org/gnumeric</A>


</P>
<P>
In addition the source code for OpenOffice is available at <A
HREF="http://www.openoffice.org/">http://www.openoffice.org/</A>

</P>
<P>
An article describing Spreadsheet::WriteExcel and how it works appears in
Issue #19 of The Perl Journal, <A
HREF="http://www.tpj.com/">http://www.tpj.com/</A> It is reproduced, by
kind permission, in the <CODE>doc</CODE> directory of the distro.

</P>
<P>
Please note that the provision of this information does not constitute an
invitation to start hacking at the BIFF or OLE file formats. There are more
interesting ways to waste your time. ;-)

</P>
<P>
<HR>
<H1><A NAME="WRITING_EXCEL_FILES">WRITING EXCEL FILES</A></H1>
<P>
Depending on your requirements, background and general sensibilities you
may prefer one of the following methods of getting data into Excel:

</P>
<P>
* CSV, comma separated variables or text. If the file extension is <CODE>csv</CODE>, Excel will open and convert this format automatically. Generating a valid
CSV file isn't as easy as it seems. Have a look at the DBD::RAM, DBD::CSV
and Text::CSV_XS modules.

</P>
<P>
* DBI with DBD::ADO or DBD::ODBC. Excel files contain an internal index
table that allows them to act like a database file. Using one of the
standard Perl database modules you can connect to an Excel file as a
database.

</P>
<P>
* DBI::Excel, you can also access Spreadsheet::WriteExcel using the
standard DBI interface via Kawai Takanori's DBI::Excel module <A
HREF="http://search.cpan.org/search?dist=DBI-Excel.">http://search.cpan.org/search?dist=DBI-Excel.</A>


</P>
<P>
* Win32::OLE module and office automation. This requires a Windows platform
and an installed copy of Excel. This is the most powerful and complete
method for interfacing with Excel. See <A
HREF="http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/faq/Windows/ActivePerl-Winfaq12.html">http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/faq/Windows/ActivePerl-Winfaq12.html</A>
and <A
HREF="http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/site/lib/Win32/OLE.html">http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/site/lib/Win32/OLE.html</A>
If your main platform is UNIX but you have the resources to set up a
separate Win32/MSOffice server, you can convert office documents to text,
postscript or PDF using Win32::OLE. For a demonstration of how to do this
using Perl see Docserver: <A
HREF="http://search.cpan.org/search?mode=module&query=docserver">http://search.cpan.org/search?mode=module&query=docserver</A>


</P>
<P>
* HTML tables. This is an easy way of adding formatting.

</P>
<P>
* XML, the Excel XML and HTML file specification are available from <A
HREF="http://msdn.microsoft.com/library/officedev/ofxml2k/ofxml2k.htm">http://msdn.microsoft.com/library/officedev/ofxml2k/ofxml2k.htm</A>


</P>
<P>
<HR>
<H1><A NAME="READING_EXCEL_FILES">READING EXCEL FILES</A></H1>
<P>
To read data from Excel files try:

</P>
<P>
* Spreadsheet::ParseExcel. This uses the OLE::Storage-Lite module to
extract data from an Excel file. <A
HREF="http://search.cpan.org/search?dist=Spreadsheet-ParseExcel">http://search.cpan.org/search?dist=Spreadsheet-ParseExcel</A>


</P>
<P>
* OLE::Storage, aka LAOLA. This is a Perl interface to OLE file formats. In
particular, the distro contains an Excel to HTML converter called Herbert,
<A
HREF="http://user.cs.tu-berlin.de/~schwartz/pmh/">http://user.cs.tu-berlin.de/~schwartz/pmh/</A>
This has been superseded by the Spreadsheet::ParseExcel module. There is
also an open source C/C++ project based on the LAOLA work. Try the Filters
Project <A
HREF="http://atena.com/libole2.php">http://atena.com/libole2.php</A> and
the Excel to HTML converter at the xlHtml Project <A
HREF="http://www.xlhtml.org/">http://www.xlhtml.org/</A>

</P>
<P>
* HTML tables. If the files are saved from Excel in a HTML format the data
can be accessed using HTML::TableExtract <A
HREF="http://search.cpan.org/search?dist=HTML-TableExtract">http://search.cpan.org/search?dist=HTML-TableExtract</A>


</P>
<P>
* DBI with DBD::ADO or DBD::ODBC. See, the section <A HREF="#WRITING_EXCEL_FILES">WRITING EXCEL FILES</A>.

</P>
<P>
* DBI::Excel, you can also access Spreadsheet::ParseExcel using the
standard DBI interface via Kawai Takanori's DBI::Excel module <A
HREF="http://search.cpan.org/search?dist=DBI-Excel.">http://search.cpan.org/search?dist=DBI-Excel.</A>


</P>
<P>
* XML::Excel converts Excel files to XML using Spreadsheet::ParseExcel <A
HREF="http://search.cpan.org/search?dist=XML-Excel.">http://search.cpan.org/search?dist=XML-Excel.</A>
 

</P>
<P>
* Win32::OLE module and office automation. See, the section <A HREF="#WRITING_EXCEL_FILES">WRITING EXCEL FILES</A>.

</P>
<P>
If you wish to view Excel files on a UNIX/Linux platform check out the
excellent Gnumeric spreadsheet application at <A
HREF="http://www.gnome.org/projects/gnumeric/">http://www.gnome.org/projects/gnumeric/</A>
or OpenOffice at <A
HREF="http://www.openoffice.org/">http://www.openoffice.org/</A>

</P>
<P>
If you wish to view Excel files on a Windows platform which doesn't have
Excel installed you can use the free Microsoft Excel Viewer <A
HREF="http://officeupdate.microsoft.com/2000/downloaddetails/xlviewer.htm">http://officeupdate.microsoft.com/2000/downloaddetails/xlviewer.htm</A>


</P>
<P>
<HR>
<H1><A NAME="BUGS">BUGS</A></H1>
<P>
Orange isn't.

</P>
<P>
Formulas are formulae.

</P>
<P>
Spreadsheet::ParseExcel: All formulas created by Spreadsheet::WriteExcel
are read as having a value of zero. This is because Spreadsheet::WriteExcel
only stores the formula and not the calculated result.

</P>
<P>
OpenOffice: Numerical formats are not displayed due to some missing records
in Spreadsheet::WriteExcel. Someone with a good knowledge of C++, and
possibly of German, might help me to track this down in the OpenOffice
source. URLs are not displayed as links.

</P>
<P>
Gnumeric: Some formatting is not displayed correctly. URLs are not
displayed as links.

</P>
<P>
MS Access: The Excel files that are produced by this module are not
compatible with MS Access. Use DBI or ODBC instead.

</P>
<P>
QuickView: If you wish to write files that are fully compatible with
QuickView it is necessary to write the cells in a sequential row by row
order.

</P>
<P>
The lack of a portable way of writing a little-endian 64 bit IEEE float.

</P>
<P>
<HR>
<H1><A NAME="TO_DO">TO DO</A></H1>
<P>
The roadmap is as follows:

</P>
<UL>
<LI><A NAME="item_More">More page set-up features. The aim is to support all the page setup features that are available through Excel's page setup dialog. Also vertical and horizontal page breaks will be added.</A>
<LI><A NAME="item_Add">Add cell protection and formula hiding.</A>
<LI><A NAME="item_Add">Add handling for non-English formula syntax and numbers in different locales.</A>
<LI><A NAME="item_Move">Move to Excel97/2000 format as standard. This will allow strings greater than 255 characters (who thought up that limit) and hopefully Unicode. The Excel 5 format will be optional.</A>
</UL>
<P>
Also, here are some of the most requested features that probably won't get
added:

</P>
<UL>
<LI><A NAME="item_Graphs">Graphs. The format is documented but it would require too much work to implement. It would also require too much work to design a useable interface to the hundreds of features in an Excel graph. So that's two too much works.</A>
<LI><A NAME="item_Macros">Macros. This would solve the previous problem neatly. However, the format of Excel macros isn't documented.</A>
<LI><A NAME="item_Some">Some feature that you really need. ;-)</A>
</UL>
<P>
If there is some feature of an Excel file that you really, really need then
you should use Win32::OLE with Excel on Windows. If you are on Unix, then
set up a Windows server and use SOAP or CORBA or get your clients to use
Gnumeric, it's better than Excel anyway.

</P>
<P>
<HR>
<H1><A NAME="ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</A></H1>
<P>
The following people contributed to the debugging and testing of
Spreadsheet::WriteExcel:

</P>
<P>
Alexander Farber, Arthur@ais, Artur Silveira da Cunha, Borgar Olsen, Cedric
Bouvier, CPAN testers, Daniel Berger, Daniel Gardner, Harold Bamford, James
Holmes, Johan Ekenberg, J.C. Wren, Kenneth Stacey, Michael Buschauer, Mike
Blazer, Paul J. Falbe, Paul Medynski, Peter Dintelmann, Rich Sorden, Shane
Ashby, Shenyu Zheng.

</P>
<P>
The following people contributed code or examples:

</P>
<P>
Andrew Benham, Bill Young, Marco Geri, Sam Kington, Takanori Kawai, Tom
O'Sullivan.

</P>
<P>
Additional thanks to Takanori Kawai for translating the documentation into
Japanese: <A
HREF="http://member.nifty.ne.jp/hippo2000/perltips/Spreadsheet/WriteExcel.htm">http://member.nifty.ne.jp/hippo2000/perltips/Spreadsheet/WriteExcel.htm</A>


</P>
<P>
Thanks to Damian Conway for the excellent Parse::RecDescent. Thanks to
Michael Meeks for his work on Gnumeric.

</P>
<P>
<HR>
<H1><A NAME="AUTHOR">AUTHOR</A></H1>
<P>
John McNamara <A HREF="mailto:jmcnamara@cpan.org">jmcnamara@cpan.org</A>

</P>
<P>
<PRE>
    Waking up from bad dreams and smoking cigarettes
    Cuddling a warm girl and smelling stale perfume
    A hot summer's day, and sticky black tarmac
    Feeding ducks in the park, and wishing you were far away
    
    That's entertainment
    
    Two lovers kissing amongst the scream of midnight
    Two lovers missing the tranquility of solitude
    Getting a cab and travelling on buses
    Reading the graffiti about slash-seat affairs
    
    That's entertainment.
    
        --Paul Weller
</PRE>
</P>
<P>
<HR>
<H1><A NAME="COPYRIGHT">COPYRIGHT</A></H1>
<P>
 MM-MMI, John McNamara.

</P>
<P>
All Rights Reserved. This module is free software. It may be used,
redistributed and/or modified under the same terms as Perl itself.

</P>

</BODY>

</HTML>
